$(document).ready((function(){function e(){loadingOnScreen(),$.ajax({method:"GET",url:"/api/apps/reportana",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){loadingOnScreenRemove(),errorAjaxResponse(e)},success:function(e){if($("#content").html(""),isEmpty(e.projects))$("#project-empty").show(),$("#no-integration-found").hide(),$("#integration-actions").hide();else{$("#project_id, #select_projects_edit").html("");for(var t=e.projects,a=0;a<t.length;a++)$("#project_id, #select_projects_edit").append('<option value="'+t[a].id+'">'+t[a].name+"</option>");if(isEmpty(e.integrations))$("#no-integration-found").show();else{$("#content").html("");for(var o=e.integrations,n=0;n<o.length;n++)r=o[n],$("#content").append('\n                            <div class="col-sm-6 col-md-4 col-lg-3 col-xl-3">\n                                <div class="card shadow card-edit" project='+r.id+" style='cursor:pointer;'>\n                                    <img class=\"card-img-top img-fluid w-full\" src="+r.project_photo+' onerror="this.onerror=null;this.src=\'/build/global/img/produto.png\';" alt="'+r.project_name+'"/>\n                                    <div class="card-body">\n                                        <div class=\'row\'>\n                                            <div class=\'col-md-10\'>\n                                                <h4 class="card-title">'+r.project_name+'</h4>\n                                                <p class="card-text sm">Criado em '+r.created_at+"</p>\n                                            </div>\n                                            <div class='col-md-2'>\n                                                <a role='button' title='Excluir' class='delete-integration float-right mt-35' project="+r.id+">\n                                                    <span class='o-bin-1 pointer'></span>\n                                                </a>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        ");$("#no-integration-found").hide()}$("#project-empty").hide(),$("#integration-actions").show()}var r;loadingOnScreenRemove()}})}e(),$(".check").on("click",(function(){$(this).is(":checked")?$(this).val(1):$(this).val(0)})),$("#btn-add-integration").on("click",(function(){$(".modal-title").html("Adicionar nova Integração com Reportana"),$("#bt_integration").addClass("btn-save"),$("#bt_integration").removeClass("btn-update"),$("#bt_integration").text("Adicionar integração"),$("#modal_add_integracao").modal("show"),$("#form_update_integration").hide(),$("#form_add_integration").show(),$("#url_api").val(""),$(":checkbox").prop("checked",!0).val(1),$("#project_id, #select_projects_edit").prop("selectedIndex",0).change()})),$(document).on("click",".card-edit",(function(){$(".modal-title").html("Editar Integração com Reportana"),$("#bt_integration").addClass("btn-update"),$("#bt_integration").removeClass("btn-save"),$("#bt_integration").text("Atualizar"),$("#form_update_integration").show(),$("#form_add_integration").hide(),$("#modal_add_integracao").modal("show"),$.ajax({method:"GET",url:"/api/apps/reportana/"+$(this).attr("project"),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){var t=e.data;$("#select_projects_edit").val(t.project_id),$("#integration_id").val(t.id),$("#url_api_edit").val(t.url_api),$("#boleto_generated_edit").val(t.boleto_generated).prop("checked",1===t.boleto_generated),$("#boleto_paid_edit").val(t.boleto_paid).prop("checked",1===t.boleto_paid),$("#boleto_expired_edit").val(t.boleto_expired).prop("checked",1===t.boleto_expired),$("#pix_generated_edit").val(t.pix_generated).prop("checked",1===t.pix_generated),$("#pix_paid_edit").val(t.pix_paid).prop("checked",1===t.pix_paid),$("#pix_expired_edit").val(t.pix_expired).prop("checked",1===t.pix_expired),$("#credit_card_refused_edit").val(t.credit_card_refused).prop("checked",1===t.credit_card_refused),$("#credit_card_paid_edit").val(t.credit_card_paid).prop("checked",1===t.credit_card_paid),$("#abandoned_cart_edit").val(t.abandoned_cart).prop("checked",1===t.abandoned_cart)}})})),$(document).on("click",".btn-save",(function(){if(""==$("#url_api").val())return alertCustom("error","Dados informados inválidos"),!1;var t=new FormData(document.getElementById("form_add_integration"));$.ajax({method:"POST",url:"/api/apps/reportana",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:t,error:function(e){errorAjaxResponse(e)},success:function(t){e(),alertCustom("success",t.message)}})})),$(document).on("click",".btn-update",(function(){if(""==$("#url_api_edit").val())return alertCustom("error","Dados informados inválidos"),!1;var t=$("#integration_id").val(),a=new FormData(document.getElementById("form_update_integration"));$.ajax({method:"POST",url:"/api/apps/reportana/"+t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:a,error:function(e){errorAjaxResponse(e)},success:function(t){e(),alertCustom("success",t.message)}})})),$(document).on("click",".delete-integration",(function(t){t.stopPropagation();var a=$(this).attr("project");$(this).parent().parent().parent().parent().parent().find(".card-edit").unbind("click"),$.ajax({method:"DELETE",url:"/api/apps/reportana/"+a,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(t){e(),alertCustom("success",t.message)}})}))}));
