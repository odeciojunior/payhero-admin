$("#company-navbar").change((function(){verifyIfCompanyIsDefault()||($("#no-integration-found").hide(),loadOnAny("#content"),updateCompanyDefault().done((function(n){getCompaniesAndProjects().done((function(n){window.fillProjectsSelect(n.company_default_projects),window.index("n",n)}))})))})),$(document).ready((function(){function n(n){$("#content").append('\n                            <div class="col-sm-6 col-md-4 col-lg-3 col-xl-3">\n                                <div class="card shadow card-edit" project='+n.id+" style='cursor:pointer;'>\n                                    <a href=\"/apps/activecampaign/".concat(n.id,'" class="activecampaign-link">\n                                        <img class="card-img-top img-fluid w-full" src=')+n.project_photo+' onerror="this.onerror=null;this.src=\'/build/global/img/produto.png\';" alt="'+n.project_name+"\"/>\n                                    </a>\n                                    <div class=\"card-body\">\n                                        <div class='row'>\n                                            <div class='col-md-10'>\n                                                <a href=\"/apps/activecampaign/".concat(n.id,'" class="activecampaign-link">\n                                                    <h4 class="card-title">')+n.project_name+'</h4>\n                                                    <p class="card-text sm">Criado em '+n.created_at+"</p>\n                                                </a>\n                                            </div>\n                                            <div class='col-md-2'>\n                                                <div role='button' title='Excluir' class='delete-integration pointer float-right mt-35' project="+n.id+">\n                                                    <span class='o-bin-1'></span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        ")}window.fillProjectsSelect=function(n){$.each(n,(function(n,t){1==t.status&&$("#project_id, #select_projects_edit").append($("<option>",{value:t.id,text:t.name}))}))},window.index=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y",e=arguments.length>1?arguments[1]:void 0;"y"==t&&loadingOnScreen(),$.ajax({method:"GET",url:"/api/apps/activecampaign?company="+$("#company-navbar").val(),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(n){loadOnAny("#content",!0),loadingOnScreenRemove(),errorAjaxResponse(n)},success:function(a){if($("#content").html(""),isEmpty(e.company_default_projects))$("#project-empty").show(),$("#integration-actions").hide();else{if($("#project_id, #select_projects_edit").html(""),window.fillProjectsSelect(e.company_default_projects),isEmpty(a.integrations))$("#no-integration-found").show();else{$("#content").html("");for(var o=a.integrations,i=0;i<o.length;i++)n(o[i]);$("#no-integration-found").hide()}$("#project-empty").hide(),$("#integration-actions").show()}"y"==t?loadingOnScreenRemove():loadOnAny("#content",!0)}})},getCompaniesAndProjects().done((function(n){window.index("y",n)})),$(".check").on("click",(function(){$(this).is(":checked")?$(this).val(1):$(this).val(0)})),$("#btn-add-integration").on("click",(function(){$(".modal-title").html("Adicionar nova Integração com ActiveCampaign"),$("#bt_integration_add").addClass("btn-save"),$("#bt_integration_add").removeClass("btn-update"),$("#bt_integration_add").text("Adicionar integração"),$("#modal_add_integracao").modal("show"),$("#form_update_integration").hide(),$("#form_add_integration").show(),$(":text").val(""),$(":checkbox").prop("checked",!0).val(1),$("#project_id, #select_projects_edit").prop("selectedIndex",0).change()})),$(document).on("click",".btn-save",(function(){if(""==$("#link").val())return alertCustom("error","Dados informados inválidos"),!1;var n=new FormData(document.getElementById("form_add_integration"));$.ajax({method:"POST",url:"/api/apps/activecampaign",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:n,error:function(n){errorAjaxResponse(n)},success:function(n){window.index(),alertCustom("success",n.message)}})})),$(document).on("click",".btn-update",(function(){if(""==$("#link_edit").val())return alertCustom("error","Dados informados inválidos"),!1;var n=$("#integration_id").val(),t=new FormData(document.getElementById("form_update_integration"));$.ajax({method:"POST",url:"/api/apps/activecampaign/"+n,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:t,error:function(n){errorAjaxResponse(n)},success:function(n){window.index(),alertCustom("success",n.message)}})})),$(document).on("click",".delete-integration",(function(n){n.stopPropagation();var t=$(this).attr("project");$(this).parent().parent().parent().parent().parent().find(".card-edit").unbind("click"),$.ajax({method:"DELETE",url:"/api/apps/activecampaign/"+t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(n){errorAjaxResponse(n)},success:function(n){window.index(),alertCustom("success",n.message)}})}))}));
