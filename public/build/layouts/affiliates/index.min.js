$(document).ready(function(){var a,t=$(window.location.pathname.split("/")).get(-1),o=0;loadOnAny(".page-content"),$.ajax({method:"GET",url:"/api/affiliates/"+t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(a){loadOnAny(".page-content",!0),errorAjaxResponse(a)},success:function(a){loadOnAny(".page-content",!0),$(".page-content").show(),a.data.status_url_affiliates?($(".div-project").show(),$(".project-header").html("Afiliação na loja ".concat(a.data.name)),$(".project-image").prop("src","".concat(a.data.photo?a.data.photo:"/build/global/img/projeto.svg")),$("#created_by").html("Produtor: ".concat(a.data.user_name)),$(".text-about-project").html(a.data.description),null!=a.data.url_page&&"https://"!=a.data.url_page?$(".url_page").html(" <strong >URL da página principal: <a href='".concat(a.data.url_page,"' target='_blank'>").concat(a.data.url_page,"</a></strong>")):$(".url_page").html(" <strong >URL da página principal: Não configurado</strong>"),$(".created_at").html(" <strong >Criado em: ".concat(a.data.created_at,"</strong>")),a.data.producer||(""!=a.data.affiliatedMessage?($(".div-button").html('<div class="alert alert-info">'.concat(a.data.affiliatedMessage,"</div>")),$(".div-button").toggleClass("text-center")):a.data.automatic_affiliation?$(".div-button").html('<button id="btn-affiliation" class="btn btn-primary" data-type="affiliate">Confimar Afiliação</button>'):$(".div-button").html('<button id="btn-affiliation" class="btn btn-primary" data-type="affiliate_request">Solicitar Afiliação</button>')),null!=a.data.percentage_affiliates?$(".percentage-affiliate").html("<strong>Porcentagem de afiliado: <span class='green-gradient'>".concat(a.data.percentage_affiliates,"%</span></strong>")):$(".percentage-affiliate").html("<strong>Porcentagem de afiliado: <span class='green-gradient'>Não configurado</span></strong>"),null!=a.data.cookie_duration?0==a.data.cookie_duration?$(".cookie_duration").html(" <strong>Duração do cookie: <span class='green-gradient'>Eterno</span></strong>"):a.data.cookie_duration>=1&&$(".cookie_duration").html(" <strong>Duração do cookie: <span class='green-gradient'>".concat(a.data.cookie_duration," dias</span></strong>")):$(".cookie_duration").html(" <strong>Duração do cookie: <span class='green-gradient'>Não configurado</span></strong>"),null!=a.data.terms_affiliates?$(".text-terms").html(a.data.terms_affiliates):$(".text-terms").html("<strong >Não possui termos de afiliação.</strong>"),null!=a.data.contact?$(".contact").html("<strong>E-mail: ".concat(a.data.contact,"</strong>")):$(".contact").html("<strong>E-mail: Não configurado</strong>"),null!=a.data.support_phone?$(".support_phone").html("<strong>Telefone: ".concat(a.data.support_phone,"</strong>")):$(".support_phone").html("<strong>Telefone: Não configurado</strong>"),$(".release_days").html("<strong>Dias para liberar dinheiro: <span class='green-gradient'>".concat(a.data.billet_release_days,"</span> dias</strong>"))):swal({title:"Essa loja não está disponível para afiliação",type:"warning",confirmButtonColor:"#EC6421",confirmButtonClass:"btn btn-warning",confirmButtonText:"OK"}).then(function(a){window.location.replace("/dashboard")})}}),$.ajax({method:"GET",url:"/api/core/usercompanies",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(a){},success:function(t){a=t.companies.length,$(t.companies).each(function(a,t){companyIsApproved(t)&&t.active_flag&&(o++,$("#companies").append("\n                            <option value='".concat(t.id,"'>\n                                ").concat("pending"==t.company_document_status?t.name+" (documentos pendentes)":t.name,"\n                            </option>\n                        ")))})}}),$(document).on("click","#btn-affiliation",function(){0==a?$("#modal-not-companies").modal("show"):0==o?$("#modal-not-companies-approved").modal("show"):$("#modal_store_affiliate").modal("show")}),$(document).on("click","#btn-store-affiliation",function(){loadingOnScreen();var a=$("#btn-affiliation").data("type");$("#btn-affiliation").hide(),$.ajax({method:"POST",url:"/api/affiliates",dataType:"json",data:{project_id:t,type:a,company_id:$("#companies").val()},headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(a){$("#modal_store_affiliate").modal("hide"),loadingOnScreenRemove(),$("#btn-affiliation").show(),errorAjaxResponse(a)},success:function(a){$("#modal_store_affiliate").modal("hide"),loadingOnScreenRemove(),alertCustom("success",a.message),"affiliate"==a.type?window.location="/projects":setTimeout(function(){window.location="/dashboard"},4e3)}})})});
