function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}$(document).ready((function(){$(".company-navbar").change((function(){verifyIfCompanyIsDefault($(this).val())||($("#integration-actions").hide(),$("#no-integration-found").hide(),$("#project-empty").hide(),loadOnAny("#content"),updateCompanyDefault().done((function(a){getCompaniesAndProjects().done((function(a){e=a,t("n")}))})))}));var e="";function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";"y"==t?loadingOnScreen():loadOnAny("#content"),$hasProjects=!1,e.company_default_projects&&$.each(e.company_default_projects,(function(e,t){1==t.status&&($hasProjects=!0)})),$hasProjects?$.ajax({method:"GET",url:"/api/apps/whatsapp2?company="+$(".company-navbar").val(),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){loadOnAny("#content",!0),loadingOnScreenRemove(),errorAjaxResponse(e)},success:function(a){if($("#project_id, #select_projects_edit").html(""),fillSelectProject(e,"#project_id, #select_projects_edit"),$("#inputTokenWhats2").val(a.token_whatsapp2),isEmpty(a.integrations))$("#no-integration-found").show();else{$("#content").html("");var n,o=_createForOfIteratorHelper(a.integrations);try{for(o.s();!(n=o.n()).done;){var r=n.value;i=r,$("#content").append('\n                            <div class="col-sm-6 col-md-4 col-lg-3 col-xl-3">\n                                <div class="card shadow card-edit" project='+i.id+' style=\'cursor:pointer;\'>\n                <div class="d-flex align-items-center justify-content-center"   >\n                                    <img class="card-img-top img-fluid w-full" src='+i.project_photo+' onerror="this.onerror=null;this.src=\'/build/global/img/produto.svg\';" alt="'+i.project_name+'"/>\n                </div>\n                                    <div class="card-body">\n                                        <div class=\'row\'>\n                                            <div class=\'col-md-10\'>\n                                                <h4 class="card-title">'+i.project_name+'</h4>\n                                                <p class="card-text sm">Criado em '+i.created_at+"</p>\n                                            </div>\n                                            <div class='col-md-2'>\n                                                <a role='button' title='Excluir' class='delete-integration float-right mt-35' project="+i.id+'>\n                                                    <img src="/build/global/img/icon-trash-new.svg" />\n                                                </a>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        ')}}catch(e){o.e(e)}finally{o.f()}$("#no-integration-found").hide()}var i;$("#project-empty").hide(),$("#integration-actions").show(),"y"==t&&loadOnAny("#content",!0),loadingOnScreenRemove()}}):($("#integration-actions").hide(),$("#no-integration-found").hide(),$("#project-empty").show(),loadingOnScreenRemove(),loadOnAny("#content",!0))}getCompaniesAndProjects().done((function(a){e=a,t()})),$("#btnCopyTokenWhats2").on("click",(function(){document.getElementById("inputTokenWhats2").select(),document.execCommand("copy"),alertCustom("success","Token copiado!")})),$(".check").on("click",(function(){$(this).is(":checked")?$(this).val(1):$(this).val(0)})),$("#btn-add-integration").on("click",(function(){$(".modal-title").html("Adicionar nova Integração com SAK"),$("#bt_integration").addClass("btn-save"),$("#bt_integration").removeClass("btn-update"),$("#bt_integration").text("Adicionar integração"),$("#modal_add_integracao").modal("show"),$("#form_update_integration").hide(),$("#form_add_integration").show(),$("#url_checkout").val(""),$("#url_order").val(""),$(":checkbox").prop("checked",!0).val(1),$("#project_id, #select_projects_edit").prop("selectedIndex",0).change()})),$(document).on("click",".card-edit",(function(){$(".modal-title").html("Editar Integração com SAK"),$("#bt_integration").addClass("btn-update"),$("#bt_integration").removeClass("btn-save"),$("#bt_integration").text("Atualizar"),$("#form_update_integration").show(),$("#form_add_integration").hide(),$("#modal_add_integracao").modal("show"),$.ajax({method:"GET",url:"/api/apps/whatsapp2/"+$(this).attr("project"),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){$("#select_projects_edit").val(e.data.project_id),$("#integration_id").val(e.data.id),$("#url_checkout_edit").val(e.data.url_checkout),$("#url_order_edit").val(e.data.url_order),$("#boleto_generated_edit").val(e.data.boleto_generated),$("#boleto_generated_edit").prop("checked","1"==$("#boleto_generated_edit").val()),$("#boleto_paid_edit").val(e.data.boleto_paid),$("#boleto_paid_edit").prop("checked","1"==$("#boleto_paid_edit").val()),$("#credit_card_refused_edit").val(e.data.credit_card_refused),$("#credit_card_refused_edit").prop("checked","1"==$("#credit_card_refused_edit").val()),$("#credit_card_paid_edit").val(e.data.credit_card_paid),$("#credit_card_paid_edit").prop("checked","1"==$("#credit_card_paid_edit").val()),$("#abandoned_cart_edit").val(e.data.abandoned_cart),$("#abandoned_cart_edit").prop("checked","1"==$("#abandoned_cart_edit").val()),$("#pix_expired_edit").val(e.data.pix_expired),$("#pix_expired_edit").prop("checked","1"==$("#pix_expired_edit").val()),$("#pix_paid_edit").val(e.data.pix_paid),$("#pix_paid_edit").prop("checked","1"==$("#pix_paid_edit").val())}})})),$(document).on("click",".btn-save",(function(){if($("#url_checkout").val().length<0||$("#url_order").val().length<0)return alertCustom("error","Dados informados inválidos"),!1;$.ajax({method:"POST",url:"/api/apps/whatsapp2",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:new FormData(document.getElementById("form_add_integration")),error:function(e){errorAjaxResponse(e)},success:function(e){t(),alertCustom("success",e.message)}})})),$(document).on("click",".btn-update",(function(){if($("#url_checkout_edit").val().length<0||$("#url_order_edit").val().length<0)return alertCustom("error","Dados informados inválidos"),!1;$.ajax({method:"POST",url:"/api/apps/whatsapp2/"+$("#integration_id").val(),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:new FormData(document.getElementById("form_update_integration")),error:function(e){errorAjaxResponse(e)},success:function(e){t(),alertCustom("success",e.message)}})})),$(document).on("click",".delete-integration",(function(e){e.stopPropagation();var t=$(this).attr("project");$("#modal-delete-integration .btn-delete").attr("project",t),$("#modal-delete-integration").modal("show")})),$(document).on("click","#modal-delete-integration .btn-delete",(function(e){e.stopPropagation();var a=$(this).attr("project");$("a[class='delete-integration float-right mt-35'][project='"+a+"']").parent().parent().parent().parent().parent().find(".card-edit").unbind("click"),$.ajax({method:"DELETE",url:"/api/apps/whatsapp2/"+a,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){t(),alertCustom("success",e.message)}})}))}));
