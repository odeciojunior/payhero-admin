$(document).ready((function(){var t;document.referrer.match(/http(s?):\/\/[\w.-]+\/products\/\w{15}\/edit/)||localStorage.removeItem("filtersApplied");var e={1:"#2E85EC",2:"#5EE2A1",3:"#F41C1C"},a={1:"Em anÃ¡lise",2:"Aprovado",3:"Recusado"},o=function(){return localStorage.getItem("filtersApplied")?JSON.parse(localStorage.getItem("filtersApplied")):0};function c(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=o;var n=function(){return null!=localStorage.getItem("filtersApplied")?JSON.parse(localStorage.getItem("filtersApplied")):null};if(null!=o){var r={atualPage:t};localStorage.setItem("page",JSON.stringify(r))}if(null!=localStorage.getItem("page")){var s=JSON.parse(localStorage.getItem("page"));null!=n()&&""!=n().getName?null!=localStorage.getItem("page")&&localStorage.setItem("page",JSON.stringify(s)):t=s.atualPage,s=JSON.parse(localStorage.getItem("page")),t=s.atualPage}o=t,loadOnAny(".page-content");var l=null!=n()?n().getTypeProducts:$("#type-products").val(),i=null!=n()?n().getName:$("#name").val(),d=null!=n()?n().getProject:$("#select-projects").val();o=null==o?"/api/products?shopify="+l+"&project="+d+"&name="+i:"/api/products"+o+"&shopify="+l+"&project="+d+"&name="+i,$.ajax({method:"GET",url:o,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){loadOnAny(".page-content",!0),errorAjaxResponse(t)},success:function(t){if(isEmpty(t.data))null!=localStorage.getItem("filtersApplied")&&null!=localStorage.getItem("page")?(localStorage.removeItem("page"),$("#btn-filtro").trigger("click")):($("#data-table-products, #pagination-products").html(""),$(".products-is-empty").show());else{var o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$('.menu_product_tooltip[style*="display: block"]').each((function(e,a){t[0]!=a&&(a.style.display="none")}))};$(".products-is-empty").hide(),$("#data-table-products").html("");var n="";$.each(t.data,(function(t,o){shopifyProduct=o.id!=o.id_view,n='\n                        <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex">\n                            <div class="card shadow mb-20 mx-0" style="flex: 1 1 100%">\n                                <div style="margin: 10px 10px 0px 0px;position: absolute;right: 0px;">\n                                    <button type="button" class="menu_product" data-id="'.concat(o.id,'">&#8942;</button>\n                                </div>\n                                <img class="card-img-top product-image pointer" src="').concat(o.image,'" alt="Imagem do produto" data-link="/products/').concat(o.id,'/edit">\n                                ').concat(2==o.type_enum?'<span class="ribbon-inner ribbon-primary" style="background-color:'.concat(e[o.status_enum],';border-radius: 0px 10px 10px 0px;"> ').concat(a[o.status_enum],"\n                                        </span>"):"",'\n                                <hr class="mt-0">\n                                <div class="card-body py-0">\n                                    <h5 class="card-title">').concat(o.name,'</h5>\n                                    <h5 class="card-description">').concat(o.description,'</h5>\n                                </div>\n                                <div class="card-footer bg-transparent">\n                                    <p class="text-muted card-text sm">Criado em ').concat(o.created_at,'</p>\n                                </div>\n                            </div>\n                            <div class="menu_product_tooltip" data-id="').concat(o.id,'">\n                                <a id="bt_editar" href="/products/').concat(o.id,'/edit" class="mx-20"><span class="o-edit-1 mr-10" />Editar produto</a>\n                                ').concat(0==shopifyProduct?'\n                                    <hr class="my-5">\n                                    <a href="#" class="mx-20 bt_excluir" data-id="'.concat(o.id,'"><span class="o-bin-1 mr-10" />Excluir produto</a>\n                                '):"","\n                            </div>\n                        </div>\n                        "),$("#data-table-products").append(n)})),$(".product-image").off("click"),$(".product-image").on("click",(function(){window.location.href=$(this).attr("data-link")})),$(".menu_product").off("click"),$(".menu_product").on("click",(function(){var t=$('.menu_product_tooltip[data-id="'.concat(this.dataset.id,'"]'));o(t),t.toggle()})),$(".menu_product").off("focusout"),$(".menu_product").on("focusout",(function(t){$(t.relatedTarget).hasClass("menu_product")||setTimeout((function(){return o()}),200)})),$(".bt_excluir").off("click"),$(".bt_excluir").on("click",(function(t){t.preventDefault(),$(".bt_excluir_modal").attr("data-id",this.dataset.id),$("#modal-delete").modal()})),$(".bt_excluir_modal").off("click"),$(".bt_excluir_modal").on("click",(function(t){t.preventDefault(),loadingOnScreen(),$.ajax({method:"DELETE",url:"/api/products/"+this.dataset.id,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t),$(".bt_excluir_modal").attr("data-id",""),loadingOnScreenRemove()},success:function(t){alertCustom("success",t.message),window.location="/products"}})})),$("img").on("error",(function(){$(this).attr("src","https://cloudfox-files.s3.amazonaws.com/produto.svg")})),pagination(t,"products",c),$(".products-is-empty").hide()}setTimeout((function(){loadOnAny(".page-content",!0)}),2e3)}})}$(document).on("keypress",(function(t){"Enter"==t.key&&$("#btn-filtro").trigger("click")})),$("#type-products").on("change",(function(){var t=$(this).val(),e=$("#select-projects");console.log(e.hasClass("has_shopify")),"1"===t&&e.hasClass("has_shopify")?($("#projects-list").removeClass("d-none"),$("#projects-list select").prop("disabled",!1).removeClass("disabled"),$("#opcao-vazia").remove()):(console.log("entrei"),$("#projects-list select").prop("disabled",!0).addClass("disabled"),$("#projects-list").addClass("d-none"))})),$("#btn-filtro").on("click",(function(){if((o().getTypeProducts!=$("#type-products").val()||o().getName!=$("#name").val()||o().getProject!=$("#select-projects").val())&&null!=localStorage.getItem("page")){var t=JSON.parse(localStorage.getItem("page"));t.atualPage=null,localStorage.setItem("page",JSON.stringify(t))}var e={getTypeProducts:$("#type-products option:selected").val(),getProject:$("#select-projects option:selected").val(),getName:$("#name").val()};localStorage.setItem("filtersApplied",JSON.stringify(e)),c()})),$("#new-product-button").on("click",(function(t){t.preventDefault(),$("#new-product-modal").show()})),loadingOnScreen(),$.ajax({method:"GET",url:"api/projects?select=true",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){loadingOnScreenRemove(),errorAjaxResponse(t)},success:function(t){isEmpty(t.data)?($("#project-empty").show(),$("#project-not-empty").hide(),$("#div-create").hide()):($("#project-empty").hide(),$("#project-not-empty").show(),verifyAccountFrozen()?$("#div-create").hide():$("#div-create").show(),c()),loadingOnScreenRemove()}}),$.ajax({method:"GET",url:"/api/projects?select=true",data:{status:"active"},dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t)},success:function(t){if(t.data){var e=!1;$("#select-projects").html(""),$.each(t.data,(function(t,a){a.shopify&&(e=!0,$("#select-projects").append($("<option>",{value:a.id,text:a.name})))})),e&&$("#select-projects").addClass("has_shopify")}!function(){if(null!=localStorage.getItem("filtersApplied")){var t=JSON.parse(localStorage.getItem("filtersApplied"));$("#type-products").val(t.getTypeProducts).trigger("change"),$("#select-projects").val(t.getProject),$("#name").val(t.getName),$("#btn-filtro").trigger("click")}}()}})}));
