function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}getCompaniesAndProjects().done(function(e){$(".site-navbar .sirius-select-container").addClass("disabled")}),loadingOnScreen(),$(document).ready(function(){var e=window.location.href.split("/")[4];function t(e,t){$(e).on("focus",function(){$("#caixinha-img")[0].src=$("#caixinha-img")[0].src.replace("caixinha",t)}),$(e).on("focusout",function(){$("#caixinha-img")[0].src=$("#caixinha-img")[0].src.replace(t,"caixinha")})}dropifyOptions={messages:{default:"Arraste e solte uma imagem ou ",replace:"Arraste e solte uma imagem ou selecione um arquivo",remove:"Remover",error:""},error:{fileSize:"O tamanho máximo do arquivo deve ser {{ value }}.",minWidth:"A imagem deve ter largura maior que 651px.",maxWidth:"A imagem deve ter largura menor que 651px.",minHeight:"A imagem deve ter altura maior que 651px.",maxHeight:"A imagem deve ter altura menor que 651px.",fileExtension:"A imagem deve ser algum dos formatos permitidos. ({{ value }})."},tpl:{message:'<div class="dropify-message"><span class="file-icon" /> <p>{{ default }}<span style="color: #2E85EC;">selecione um arquivo</span></p></div>',clearButton:'<button type="button" class="dropify-clear o-bin-1"></button>'},imgFileExtensions:["png","jpg","jpeg","gif","bmp","webp","svg"]},$.ajax({method:"GET",url:"/api/products/"+e+"/edit",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){loadingOnScreenRemove(),errorAjaxResponse(e),$("#product_photo").dropify(dropifyOptions)},success:function(e){isEmpty(e.data.product)?alertCustom("success","Ocorreu um erro, tente novamente mais tarde"):($.each(e.data.categories,function(e,t){$("#select-categories").append($("<option>",{value:t.id,text:t.name}))}),$("#select-categories  option[value='"+e.data.product.category_id+"']").prop("selected",!0),e.data.product.shopify_variant_id&&!e.data.product.has_sales||$(".converte-product").parent().hide(),$(".converte-product").attr("product",e.data.product.id),$(".converte-product").attr("productname",e.data.product.name),e.data.product.shopify_variant_id&&$(".delete-product").parent().hide(),$(".delete-product").attr("product",e.data.product.id),$(".delete-product").attr("productname",e.data.product.name),e.data.product.shopify_variant_id&&!e.data.product.has_sales||!e.data.product.shopify_variant_id||$("#empty-space").show(),$("#product_photo").attr("src",e.data.product.photo),$("img").on("error",function(){$(this).attr("src","https://azcend-digital-products.s3.amazonaws.com/admin/produto.svg")}),$("#name").val(e.data.product.name),$("#description").text(e.data.product.description),isEmpty(e.data.product.sku)?$("#sku").hide():($("#sku input").val(e.data.product.sku),$("#sku").show()),$("#cost").unmask().val(e.data.product.cost).mask("000.000.000.000.000,00",{reverse:!0}),$("#price").unmask().val(e.data.product.price).mask("000.000.000.000.000,00",{reverse:!0}),$("#height").unmask().val(e.data.product.height),$("#length").unmask().val(e.data.product.length),$("#width").unmask().val(e.data.product.width),$("#weight").unmask().val(e.data.product.weight),1==e.data.product.currency_type_enum?$("#select-currency .select-currency-brl").attr("selected",!0):$("#select-currency .select-currency-usd").attr("selected",!0),e.data.product.type_enum,""!=e.data.product.photo&&(dropifyOptions.defaultFile=e.data.product.photo),$("#product_photo").dropify(dropifyOptions),""!=e.data.product.digital_product_url&&($(".btn-view-product-url").attr("link",e.data.product.digital_product_url),$(".btn-view-product-url").show()),$(".div-expiration-time").show(),$("#url_expiration_time").val(e.data.product.url_expiration_time),removeImageButton=!1,$("#my-form").submit(function(t){t.preventDefault();var i=document.getElementById("my-form"),r=new FormData(i);1==e.data.product.type_enum?r.append("type_enum","physical"):r.append("type_enum","digital"),function(e){var t=!0;if(""===$.trim($("#name").val())&&($("#nav-basic-tab").click(),$("#name").focus(),alertCustom("error","O campo Nome é obrigatório"),t=!1),""===$.trim($("#description").val())&&($("#nav-basic-tab").click(),$("#description").focus(),alertCustom("error","O campo Descrição é obrigatório"),t=!1),2==e){var i=$.trim($("#url_expiration_time").val());parseInt(i)>=168&&(alertCustom("error","Expiração do link deve ser menor que 1 semana (168 HORAS)"),t=!1),""===i&&(alertCustom("error","Preencha o campo Tempo de expiração da url"),t=!1,$("#url_expiration_time").focus()),$(".btn-view-product-url").attr("link")||""!==$.trim($("#digital_product_url").val())||(alertCustom("error","Envie o arquivo digital"),t=!1,$("#digital_product_url").focus())}return t}(e.data.product.type_enum)&&(loadOnAny(".page",!1),$.ajax({method:"POST",url:"/api/products/"+e.data.product.id+"?product_photo_remove="+removeImageButton,processData:!1,cache:!1,contentType:!1,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},data:r,error:function(e){loadOnAny(".page",!0),errorAjaxResponse(e)},success:function(e){loadOnAny(".page",!0),alertCustom("success",e.message),$(".btn-view-product-url").attr("link",e.digital_product_url),window.location="/products"}}))})),loadingOnScreenRemove()}}),$(".money").mask("#.###,#0",{reverse:!0}),$("#shipping").on("change",function(){"proprio"==$(this).val()?$("#div_carrier_id").hide():$("#div_carrier_id").show()}),$(".delete-product").on("click",function(e){e.preventDefault();var t=$(".delete-product").attr("product");$("#bt_excluir").unbind("click"),$("#bt_excluir").on("click",function(){$("#close-modal-delete").click(),loadingOnScreen(),$.ajax({method:"DELETE",url:"/api/products/"+t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){loadingOnScreenRemove(),errorAjaxResponse(e)}),success:function(e){loadingOnScreenRemove(),alertCustom("success",e.message),window.location="/products"}})})}),$(".converte-product").on("click",function(e){e.preventDefault();var t=$(".converte-product").attr("product");$("#bt_converter").unbind("click"),$("#bt_converter").on("click",function(){$("#close-modal-converte").click(),loadingOnScreen(),$.ajax({method:"POST",url:"/api/products/update-product-type/"+t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){loadingOnScreenRemove(),errorAjaxResponse(e)}),success:function(e){loadingOnScreenRemove(),alertCustom("success",e.message),window.location="/products"}})})}),$(".btn-view-product-url").on("click",function(e){e.preventDefault();var t=$(this).attr("link"),i=$("#url_expiration_time").val();loadingOnScreen(),$.ajax({method:"POST",url:"/api/products/getsignedurl",dataType:"json",data:{digital_product_url:t,url_expiration_time:i},headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){loadingOnScreenRemove(),errorAjaxResponse(e)},success:function(e){loadingOnScreenRemove(),window.open(e.signed_url,"_blank")}})}),$("#url_expiration_time").mask("0#"),$("#product_photo").on("dropify.afterClear",function(e,t){removeImageButton=!0}),t("#height","caixinha-altura"),t("#width","caixinha-largura"),t("#length","caixinha-comprimento"),t("#weight","caixinha-peso"),null!=$("#digital_product_url")[0]&&$("#digital_product_url")[0].addEventListener("change",function(){productName=this.value.split("\\")[2]||"",$("#file_return")[0].innerHTML=productName.length>25?productName.substring(0,21)+productName.substring(productName.length-4):productName})}),function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t(require("jquery")):e.Dropify=t(e.jQuery)}(this,function(e){function t(t,i){if(window.File&&window.FileReader&&window.FileList&&window.Blob){this.element=t,this.input=e(this.element),this.wrapper=null,this.preview=null,this.filenameWrapper=null,this.settings=e.extend(!0,{defaultFile:"",maxFileSize:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,showRemove:!0,showLoader:!0,showErrors:!0,errorTimeout:3e3,errorsPosition:"overlay",imgFileExtensions:["png","jpg","jpeg","gif","bmp"],maxFileSizePreview:"5M",allowedFormats:["portrait","square","landscape"],allowedFileExtensions:["*"],messages:{default:"Drag and drop a file here or click",replace:"Drag and drop or click to replace",remove:"Remove",error:"Ooops, something wrong appended."},error:{fileSize:"The file size is too big ({{ value }} max).",minWidth:"The image width is too small ({{ value }}}px min).",maxWidth:"The image width is too big ({{ value }}}px max).",minHeight:"The image height is too small ({{ value }}}px min).",maxHeight:"The image height is too big ({{ value }}px max).",imageFormat:"The image format is not allowed ({{ value }} only).",fileExtension:"The file is not allowed ({{ value }} only)."},tpl:{wrap:'<div class="dropify-wrapper"></div>',loader:'<div class="dropify-loader"></div>',message:'<div class="dropify-message"><span class="file-icon" /> <p>{{ default }}</p></div>',preview:'<div class="dropify-preview"><span class="dropify-render"></span><div class="dropify-infos"><div class="dropify-infos-inner"><p class="dropify-infos-message">{{ replace }}</p></div></div></div>',filename:'<p class="dropify-filename"><span class="file-icon"></span> <span class="dropify-filename-inner"></span></p>',clearButton:'<button type="button" class="dropify-clear">{{ remove }}</button>',errorLine:'<p class="dropify-error">{{ error }}</p>',errorsContainer:'<div class="dropify-errors-container"><ul></ul></div>'}},i,this.input.data()),this.errorsEvent=e.Event("dropify.errors"),this.isDisabled=!1,this.isInit=!1,this.file={object:null,name:null,size:null,width:null,height:null,type:null},Array.isArray(this.settings.allowedFormats)||(this.settings.allowedFormats=this.settings.allowedFormats.split(" ")),Array.isArray(this.settings.allowedFileExtensions)||(this.settings.allowedFileExtensions=this.settings.allowedFileExtensions.split(" ")),this.onChange=this.onChange.bind(this),this.clearElement=this.clearElement.bind(this),this.onFileReady=this.onFileReady.bind(this),this.translateMessages(),this.createElements(),this.setContainerSize(),this.errorsEvent.errors=[],this.input.on("change",this.onChange)}}var i="dropify";return t.prototype.onChange=function(){this.resetPreview(),this.readFile(this.element)},t.prototype.createElements=function(){this.isInit=!0,this.input.wrap(e(this.settings.tpl.wrap)),this.wrapper=this.input.parent();var t=e(this.settings.tpl.message).insertBefore(this.input);e(this.settings.tpl.errorLine).appendTo(t),!0===this.isTouchDevice()&&this.wrapper.addClass("touch-fallback"),this.input.attr("disabled")&&(this.isDisabled=!0,this.wrapper.addClass("disabled")),!0===this.settings.showLoader&&(this.loader=e(this.settings.tpl.loader),this.loader.insertBefore(this.input)),this.preview=e(this.settings.tpl.preview),this.preview.insertAfter(this.input),!1===this.isDisabled&&!0===this.settings.showRemove&&(this.clearButton=e(this.settings.tpl.clearButton),this.clearButton.insertAfter(this.input),this.clearButton.on("click",this.clearElement)),this.filenameWrapper=e(this.settings.tpl.filename),this.filenameWrapper.prependTo(this.preview.find(".dropify-infos-inner")),!0===this.settings.showErrors&&(this.errorsContainer=e(this.settings.tpl.errorsContainer),"outside"===this.settings.errorsPosition?this.errorsContainer.insertAfter(this.wrapper):this.errorsContainer.insertBefore(this.input));var i=this.settings.defaultFile||"";""!==i.trim()&&(this.file.name=this.cleanFilename(i),this.setPreview(this.isImage(),i))},t.prototype.readFile=function(t){if(t.files&&t.files[0]){var i=new FileReader,r=new Image,s=t.files[0],o=null,n=this,a=e.Event("dropify.fileReady");this.clearErrors(),this.showLoader(),this.setFileInformations(s),this.errorsEvent.errors=[],this.checkFileSize(),this.isFileExtensionAllowed(),this.isImage()&&this.file.size<this.sizeToByte(this.settings.maxFileSizePreview)?(this.input.on("dropify.fileReady",this.onFileReady),i.readAsDataURL(s),i.onload=function(e){o=e.target.result,r.src=e.target.result,r.onload=function(){n.setFileDimensions(this.width,this.height),n.validateImage(),n.input.trigger(a,[!0,o])}}.bind(this)):this.onFileReady(!1)}},t.prototype.onFileReady=function(e,t,i){if(this.input.off("dropify.fileReady",this.onFileReady),0===this.errorsEvent.errors.length)this.setPreview(t,i);else{this.input.trigger(this.errorsEvent,[this]);for(var r=this.errorsEvent.errors.length-1;r>=0;r--){var s=this.errorsEvent.errors[r].namespace.split(".").pop();this.showError(s)}if(void 0!==this.errorsContainer){this.errorsContainer.addClass("visible");var o=this.errorsContainer;setTimeout(function(){o.removeClass("visible")},this.settings.errorTimeout)}this.wrapper.addClass("has-error"),this.resetPreview(),this.clearElement()}},t.prototype.setFileInformations=function(e){this.file.object=e,this.file.name=e.name,this.file.size=e.size,this.file.type=e.type,this.file.width=null,this.file.height=null},t.prototype.setFileDimensions=function(e,t){this.file.width=e,this.file.height=t},t.prototype.setPreview=function(t,i){this.wrapper.removeClass("has-error").addClass("has-preview"),this.filenameWrapper.children(".dropify-filename-inner").html(this.file.name);var r=this.preview.children(".dropify-render");if(this.hideLoader(),!0===t){var s=e("<img />").attr("src",i);this.settings.height&&s.css("max-height",this.settings.height),s.appendTo(r)}else e("<i />").attr("class","dropify-font-file").appendTo(r),e('<span class="dropify-extension" />').html(this.getFileType()).appendTo(r);this.preview.fadeIn()},t.prototype.resetPreview=function(){this.wrapper.removeClass("has-preview");var e=this.preview.children(".dropify-render");e.find(".dropify-extension").remove(),e.find("i").remove(),e.find("img").remove(),this.preview.hide(),this.hideLoader()},t.prototype.cleanFilename=function(e){var t=e.split("\\").pop();return t==e&&(t=e.split("/").pop()),""!==e?t:""},t.prototype.clearElement=function(){if(0===this.errorsEvent.errors.length){var t=e.Event("dropify.beforeClear");this.input.trigger(t,[this]),!1!==t.result&&(this.resetFile(),this.input.val(""),this.resetPreview(),this.input.trigger(e.Event("dropify.afterClear"),[this]))}else this.resetFile(),this.input.val(""),this.resetPreview()},t.prototype.resetFile=function(){this.file.object=null,this.file.name=null,this.file.size=null,this.file.type=null,this.file.width=null,this.file.height=null},t.prototype.setContainerSize=function(){this.settings.height&&this.wrapper.height(this.settings.height)},t.prototype.isTouchDevice=function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0},t.prototype.getFileType=function(){return this.file.name.split(".").pop().toLowerCase()},t.prototype.isImage=function(){return"-1"!=this.settings.imgFileExtensions.indexOf(this.getFileType())},t.prototype.isFileExtensionAllowed=function(){return"-1"!=this.settings.allowedFileExtensions.indexOf("*")||"-1"!=this.settings.allowedFileExtensions.indexOf(this.getFileType())||(this.pushError("fileExtension"),!1)},t.prototype.translateMessages=function(){for(var e in this.settings.tpl)for(var t in this.settings.messages)this.settings.tpl[e]=this.settings.tpl[e].replace("{{ "+t+" }}",this.settings.messages[t])},t.prototype.checkFileSize=function(){0!==this.sizeToByte(this.settings.maxFileSize)&&this.file.size>this.sizeToByte(this.settings.maxFileSize)&&this.pushError("fileSize")},t.prototype.sizeToByte=function(e){var t=0;if(0!==e){var i=e.slice(-1).toUpperCase(),r=1048576;"K"===i?t=1024*parseFloat(e):"M"===i?t=parseFloat(e)*r:"G"===i&&(t=1073741824*parseFloat(e))}return t},t.prototype.validateImage=function(){0!==this.settings.minWidth&&this.settings.minWidth>=this.file.width&&this.pushError("minWidth"),0!==this.settings.maxWidth&&this.settings.maxWidth<=this.file.width&&this.pushError("maxWidth"),0!==this.settings.minHeight&&this.settings.minHeight>=this.file.height&&this.pushError("minHeight"),0!==this.settings.maxHeight&&this.settings.maxHeight<=this.file.height&&this.pushError("maxHeight"),"-1"==this.settings.allowedFormats.indexOf(this.getImageFormat())&&this.pushError("imageFormat")},t.prototype.getImageFormat=function(){return this.file.width==this.file.height?"square":this.file.width<this.file.height?"portrait":this.file.width>this.file.height?"landscape":void 0},t.prototype.pushError=function(t){var i=e.Event("dropify.error."+t);this.errorsEvent.errors.push(i),this.input.trigger(i,[this])},t.prototype.clearErrors=function(){void 0!==this.errorsContainer&&this.errorsContainer.children("ul").html("")},t.prototype.showError=function(e){void 0!==this.errorsContainer&&this.errorsContainer.children("ul").append("<li>"+this.getError(e)+"</li>")},t.prototype.getError=function(e){var t=this.settings.error[e],i="";return"fileSize"===e?i=this.settings.maxFileSize:"minWidth"===e?i=this.settings.minWidth:"maxWidth"===e?i=this.settings.maxWidth:"minHeight"===e?i=this.settings.minHeight:"maxHeight"===e?i=this.settings.maxHeight:"imageFormat"===e?i=this.settings.allowedFormats.join(", "):"fileExtension"===e&&(i=this.settings.allowedFileExtensions.join(", ")),""!==i?t.replace("{{ value }}",i):t},t.prototype.showLoader=function(){void 0!==this.loader&&this.loader.show()},t.prototype.hideLoader=function(){void 0!==this.loader&&this.loader.hide()},t.prototype.destroy=function(){this.input.siblings().remove(),this.input.unwrap(),this.isInit=!1},t.prototype.init=function(){this.createElements()},t.prototype.isDropified=function(){return this.isInit},e.fn[i]=function(r){return this.each(function(){e.data(this,i)||e.data(this,i,new t(this,r))}),this},t}),function(e,t){if("function"==typeof define&&define.amd)define("/Plugin/dropify",["exports","Plugin"],t);else if("undefined"!=typeof exports)t(exports,require("Plugin"));else{var i={exports:{}};t(i.exports,e.Plugin),e.PluginDropify=i.exports}}(this,function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=babelHelpers.interopRequireDefault(t),r="dropify",s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getName",value:function(){return r}}],[{key:"getDefaults",value:function(){return{}}}]),t}(i.default);i.default.register(r,s),e.default=s});
