var statusNotification={1:"success",0:"danger"};$((function(){var t=0,a="";$(document).on("keyup","#modal-edit-project-notification .project-notification-field",(function(n){t=this.selectionStart,a=this.id})),$(document).on("click","#modal-edit-project-notification .project-notification-field",(function(n){t=this.selectionStart,a=this.id})),$(document).on("click","#modal-edit-project-notification  .inc-param",(function(n){var e=$(this).data("value"),i=document.getElementById(a),o=i.value;i.value=o.slice(0,t)+e+o.slice(t),i.focus(),$(i).prop("selectionEnd",t+e.length)}));var n=$(window.location.pathname.split("/")).get(-1);function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=null==t?"/api/project/"+n+"/projectnotification":"/api/project/"+n+"/projectnotification"+t,loadOnTable("#data-table-sms","#tabela-sms"),$("#tab_sms-panel").find(".no-gutters").css("display","none"),$("#tabela-sms").find("thead").css("display","none"),$.ajax({method:"GET",url:t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t)},success:function(t){$("#data-table-sms").html(""),""==t.data?$("#data-table-sms").html("\n                        <tr class='text-center'>\n                            <td colspan='8' style='height: 70px; vertical-align: middle;'>\n                                <div class='d-flex justify-content-center align-items-center'>\n                                    <img src='/modules/global/img/empty-state-table.png' style='margin-right: 60px;'>\n                                    <div class='text-left'>\n                                        <h1 style='font-size: 24px; font-weight: normal; line-height: 30px; margin: 0; color: #636363;'>Nenhuma notificação configurada</h1>\n                                        <p style='font-style: normal; font-weight: normal; font-size: 16px; line-height: 20px; color: #9A9A9A;'>Cadastre a sua primeiro notificação para poder\n                                        <br>gerenciá-las nesse painel.</p>\n                                        <button type='button' style='width: auto; height: auto; padding: .429rem 1rem !important;' class='btn btn-primary add-review' data-toggle=\"modal\" data-target=\"#modal_review\">Adicionar notificação</button>\n                                    </div>\n                                </div>\n                            </td>\n                        </tr>\n                    "):($("#tab_sms-panel").find(".no-gutters").css("display","flex"),$("#tabela-sms").find("thead").css("display","contents"),$("#count-notifications").html(t.meta.total),$.each(t.data,(function(t,a){var n=1==a.status?"checked":"",e='<tr>\n                            <td class="project-notification-id">'.concat(a.type,'</td>\n\n                            <td class="project-notification-type">').concat(a.event,'</td>\n\n                            <td class="project-notification-value">').concat(a.time,'</td>\n\n                            <td class="project-notification-zip-code-origin">').concat(a.message,'</td>\n\n                            <td class="text-center project-notification-status notification-status-').concat(a.id,'" style="vertical-align: middle">\n                                <span class="badge badge-').concat(statusNotification[a.status],'">').concat(a.status_translated,'</span>\n                            </td>\n\n                            <td style="text-align:center" class="justify-content-between align-items-center mb-0">\n\n                                <div class=\'d-flex justify-content-end align-items-center\'>\n\n                                    <a role="button" title=\'Visualizar\' class="details-project-notification mg-responsive pointer" project-notification="').concat(a.id,'">\n                                        <span class="o-eye-1"></span>\n                                    </a>\n\n                                    ').concat(11==a.notification_enum||12==a.notification_enum||13==a.notification_enum||17==a.notification_enum?'<button style="background-color: transparent;" role="button" class="px-0 pb-0 btn  disabled="">\n                                            <span class="o-edit-1"></span>\n                                        </button>':'<a role="button" title="Editar" class="edit-project-notification mg-responsive pointer" project-notification=\''.concat(a.id,'\'>\n                                            <span class="o-edit-1"></span>\n                                        </a>'),'\n                                    <div class="switch-holder d-inline mg-responsive pointer mr-0" ').concat(11==a.notification_enum||12==a.notification_enum||13==a.notification_enum||17==a.notification_enum?'style=" opacity: 0.5;"':"",'>\n\n                                        <label class="switch mr-0" ').concat(11==a.notification_enum||12==a.notification_enum||13==a.notification_enum||17==a.notification_enum?'style="cursor: not-allowed"':"",'>\n\n                                            <input type="checkbox" class="project_notification_status" data-id="').concat(a.id,'" ').concat(n,"\n                                            ").concat(11==a.notification_enum||12==a.notification_enum||13==a.notification_enum||17==a.notification_enum?"disabled":"",'>\n\n\n                                            <span class="slider round" ').concat(11==a.notification_enum||12==a.notification_enum||13==a.notification_enum||17==a.notification_enum?'style="cursor: not-allowed"':"","></span>\n                                        </label>\n\n                                    </div>\n                                </div>\n                            </td>\n\n                        </tr>");$("#data-table-sms").append(e)})),pagination(t,"project-notification",e))}})}$(".tab_sms").on("click",(function(){e(),$(this).off()})),$(document).on("click",".edit-project-notification",(function(){var t=$(this).attr("project-notification");$.ajax({method:"GET",url:"/api/project/"+n+"/projectnotification/"+t+"/edit",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t)},success:function(a){$("#modal-edit-project-notification .project-notification-id").val(t),1==a.data.type_enum?$("#modal-edit-project-notification .project-notification-type").prop("selectedIndex",0).change():$("#modal-edit-project-notification .project-notification-type").prop("selectedIndex",1).change(),1==a.data.status?$("#modal-edit-project-notification .project-notification-status").prop("selectedIndex",0).change():$("#modal-edit-project-notification .project-notification-status").prop("selectedIndex",1).change(),$("#modal-edit-project-notification .project-notification-time").val(a.data.time),$("#modal-edit-project-notification .project-notification-message").val(a.data.message),$("#modal-edit-project-notification .project-notification-title").val(a.data.title),$("#modal-edit-project-notification .project-notification-subject").val(a.data.subject),a.data.event_enum>0&&$("#modal-edit-project-notification .project-notification-event").prop("selectedIndex",a.data.event_enum-1).change(),1==a.data.type_enum?($("#modal-edit-project-notification .project-notification-field-email").show(),$("#modal-edit-project-notification .project-notification-message").attr("maxlength",1e4)):($("#modal-edit-project-notification .project-notification-message").attr("maxlength",160),$("#modal-edit-project-notification .project-notification-field-email").hide()),1!=a.data.event_enum&&2!=a.data.event_enum&&5!=a.data.event_enum||2!=a.data.type_enum?$(".param-billet-url").hide():$(".param-billet-url").show(),6==a.data.event_enum?($(".param-tracking-code").show(),$(".param-tracking-url").show()):($(".param-tracking-code").hide(),$(".param-tracking-url").hide()),4==a.data.event_enum?($(".param-abandoned-cart").show(),$(".param-sale-code").hide()):($(".param-abandoned-cart").hide(),$(".param-sale-code").show()),$("#modal-edit-project-notification").modal("show")}})})),$("#modal-edit-project-notification .btn-update").on("click",(function(){var t=new FormData(document.getElementById("form-update-project-notification")),a=$("#modal-edit-project-notification .project-notification-id").val();$.ajax({method:"POST",url:"/api/project/"+n+"/projectnotification/"+a,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},data:t,processData:!1,contentType:!1,cache:!1,error:function(t){errorAjaxResponse(t)},success:function(t){alertCustom("success","Notificação atualizada com sucesso"),e()}})})),$(document).on("click",".details-project-notification",(function(){var t=$(this).attr("project-notification");$("#btn-modal").hide(),$.ajax({method:"GET",url:"/api/project/"+n+"/projectnotification/"+t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t)},success:function(t){$("#modal-detail-project-notification .projectn-type").html(t.data.type),$("#modal-detail-project-notification .projectn-time").html(t.data.time),$("#modal-detail-project-notification .projectn-event").html(t.data.event),$("#modal-detail-project-notification .projectn-message").html(t.data.message),$("#modal-detail-project-notification .projectn-subject").html(t.data.subject),$("#modal-detail-project-notification .projectn-title").html(t.data.title),$("#modal-detail-project-notification .projectn-status").html("1"==t.data.status?'<span class="badge badge-success text-left">Ativo</span>':'<span class="badge badge-danger">Inativo</span>'),2==t.data.type_enum?($(".include-templates-email").hide(),$(".tr-project-message").show()):($(".tr-project-message").hide(),$(".include-templates-email").show(),$(".templates-email").hide(),$("#modal-detail-project-notification .p_text_message").html(t.data.message_html),$("#modal-detail-project-notification .p_project_name").html(t.data.project_name),$("#modal-detail-project-notification .p_text_notification").html(t.data.title),""!=t.data.project_image&&$("#modal-detail-project-notification .p_image_project").attr("src",t.data.project_image),5==t.data.notification_enum?$(".template-billet-generated").show():6==t.data.notification_enum||7==t.data.notification_enum||8==t.data.notification_enum?$(".template-billet-next-day").show():9==t.data.notification_enum?$(".template-abandoned-cart").show():10==t.data.notification_enum?$(".template-abandoned-cart-nextday").show():12==t.data.notification_enum?$(".template-card-paid").show():13==t.data.notification_enum?$(".template-billet-paid").show():14==t.data.notification_enum&&$(".template-tracking").show()),$("#modal-detail-project-notification").modal("show")}})})),$(document).on("change",".project_notification_status",(function(){var t=0;t=this.checked?1:0;var a=this.getAttribute("data-id");$.ajax({method:"PUT",url:"/api/project/"+n+"/projectnotification/"+a,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},data:{status:t},cache:!1,error:function(t){errorAjaxResponse(t)},success:function(t){alertCustom("success","Notificação atualizada com sucesso"),1==t.status?($(".notification-status-"+a+" span").removeClass("badge-danger"),$(".notification-status-"+a+" span").addClass("badge-success"),$(".notification-status-"+a+" span").html("Ativo")):($(".notification-status-"+a+" span").removeClass("badge-success"),$(".notification-status-"+a+" span").addClass("badge-danger"),$(".notification-status-"+a+" span").html("Inativo"))}})}))}));
