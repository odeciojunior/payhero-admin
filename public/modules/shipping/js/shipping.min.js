function _createForOfIteratorHelper(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,s=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){o=!0,p=e},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw p}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var statusShipping={1:"success",0:"danger"},activeShipping={1:"success",0:"danger"};$(document).ready((function(){var e=$(window.location.pathname.split("/")).get(-1);function t(){$(".shipping-description").val(""),$(".shipping-info").val(""),$(".shipping-value").val(""),$(".shipping-zipcode").val(""),$(".rule-shipping-value").val(""),$("#shipping-plans-add").html(""),$("#shipping-not-apply-plans-add").html("");var e=$("#shipping-plans-add");e.html(""),e.append('<option value="all">Qualquer plano</option>'),e.val("all").trigger("change")}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=null==t?"/api/project/"+e+"/shippings":"/api/project/"+e+"/shippings"+t,loadOnTable("#dados-tabela-frete","#tabela_fretes"),$("#tab-fretes-panel").find(".no-gutters").css("display","none"),$("#tabela-fretes").find("thead").css("display","none"),$.ajax({method:"GET",url:t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){$("#dados-tabela-frete").html(e.message),errorAjaxResponse(e)},success:function(e){$("#dados-tabela-frete").html(""),""==e.data?$("#dados-tabela-frete").html("\n                        <tr class='text-center'>\n                            <td colspan='8' style='height: 70px; vertical-align: middle;'>\n                                <div class='d-flex justify-content-center align-items-center'>\n                                    <img src='/modules/global/img/empty-state-table.svg' style='margin-right: 60px;'>\n                                    <div class='text-left'>\n                                        <h1 style='font-size: 24px; font-weight: normal; line-height: 30px; margin: 0; color: #636363;'>Nenhum frete configurado</h1>\n                                        <p style='font-style: normal; font-weight: normal; font-size: 16px; line-height: 20px; color: #9A9A9A;'>Cadastre o seu primeiro frete para poder\n                                        <br>gerenciá-los nesse painel.</p>\n                                        <button type='button' style='width: auto; height: auto; padding: .429rem 1rem !important;' class='btn btn-primary add-shipping' data-toggle=\"modal\" data-target=\"#modal-create-shipping\">Adicionar frete</button>\n                                    </div>\n                                </div>\n                            </td>\n                        </tr>\n                    "):($("#tab-fretes-panel").find(".no-gutters").css("display","flex"),$("#tabela-fretes").find("thead").css("display","contents"),$("#count-fretes").html(e.meta.total),$.each(e.data,(function(e,t){var i='<tr>\n                                        <td style="vertical-align: middle; display: none;">'.concat(t.zip_code_origin,'</td>\n                                        <td style="vertical-align: middle;">').concat(t.type_name,'</td>\n                                        <td style="vertical-align: middle;">').concat(t.name,'</td>\n                                        <td style="vertical-align: middle;">').concat(t.value,'</td>\n                                        <td style="vertical-align: middle;">').concat(t.information,'</td>\n                                        <td class="text-center" style="vertical-align: middle;">\n                                            <span class="badge badge-').concat(statusShipping[t.status],'">').concat(t.status_translated,'</span>\n                                        </td>\n                                        <td class="text-center display-sm-none display-m-none" style="vertical-align: middle;">\n                                            <span class="badge badge-').concat(activeShipping[t.pre_selected],'">').concat(t.pre_selected_translated,"</span>\n                                        </td>\n                                        <td style='text-align:center'>\n                                            <div class='d-flex justify-content-end align-items-center'>\n                                                <a role='button' title='Visualizar' class='pointer detalhes-frete mg-responsive' frete=\"").concat(t.shipping_id,"\"><span class=\"o-eye-1\"></span></a>\n                                                <a role='button' title='Editar' class='pointer editar-frete mg-responsive' frete=\"").concat(t.shipping_id,"\"><span class='o-edit-1'></span></a>\n                                                <a role='button' title='Excluir' class='pointer excluir-frete mg-responsive' frete=\"").concat(t.shipping_id,"\" data-toggle='modal' data-target='#modal-delete-shipping'><span class='o-bin-1'></span></a>\n                                            </div>\n                                        </td>\n                                     </tr>");$("#dados-tabela-frete").append(i)})),"none"==$("#dados-tabela-frete").children("tr:first").children("td:first").css("display")?$("#dados-tabela-frete").children("tr").children("td:nth-child(2)").css("padding-left","30px"):$("#dados-tabela-frete").children("tr").children("td:nth-child(2)").css("padding-left",""),pagination(e,"shippings",i))}})}function n(t,i){(t=$(t)).select2({placeholder:"Nome do plano",multiple:!0,dropdownParent:$(i),language:{noResults:function(){return"Nenhum plano encontrado"},searching:function(){return"Procurando..."},loadingMore:function(){return"Carregando mais planos..."}},ajax:{data:function(t){return{list:"plan",search:t.term,project_id:e,page:t.page||1}},method:"GET",url:"/api/plans/user-plans",delay:300,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processResults:function(e){var t=this.$element.attr("id");if(("shipping-plans-add"===t||"shipping-plans-edit"===t)&&1===e.meta.current_page){e.data.unshift({id:"all",name:"Qualquer plano",description:""})}return{results:$.map(e.data,(function(e){return{id:e.id,text:e.name+(e.description?" - "+e.description:"")}})),pagination:{more:e.meta.current_page!==e.meta.last_page}}}}}),$(document).on("show.bs.modal","#modal-create-shipping",(function(){$("#modal-create-shipping #shipping-type").val("static").change()})),t.on("select2:select",(function(){var e=$(this);(e.val().length>1&&e.val().includes("all")||e.val().includes("all")&&"all"!==e.val())&&e.val("all").trigger("change")}))}$.ajax({url:"/api/apps/melhorenvio",data:{completed:1},headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},success:function(e){var t,i="",n=_createForOfIteratorHelper(e.data);try{for(n.s();!(t=n.n()).done;){var a=t.value;i+='<option class="menv'.concat(a.id,'" value="melhorenvio-').concat(a.id,'">').concat(a.name," (integração com a API do Melhor Envio)</option>")}}catch(e){n.e(e)}finally{n.f()}$("#shipping-type").each((function(){$(this).children("select").append(i)}))},error:function(e){}}),$(".tab-fretes").on("click",(function(){$(this).off(),$("#previewimage").imgAreaSelect({remove:!0}),i()})),$(document).on("change","#shipping-type",(function(){var e=$(this).val();"static"===e?($(".information-shipping-row").show(),$(".value-shipping-row").show(),$(".zip-code-origin-shipping-row").hide(),$(".options-shipping-row").hide(),$(".shipping-description").attr("placeholder","Frete grátis")):"pac"===e?($(".information-shipping-row").show(),$(".value-shipping-row").hide(),$(".zip-code-origin-shipping-row").show(),$(".options-shipping-row").hide(),$(".shipping-description").attr("placeholder","PAC")):"sedex"===e?($(".information-shipping-row").show(),$(".value-shipping-row").hide(),$(".zip-code-origin-shipping-row").show(),$(".options-shipping-row").hide(),$(".shipping-description").attr("placeholder","SEDEX")):e.includes("melhorenvio")&&($(".information-shipping-row").hide(),$(".value-shipping-row").hide(),$(".zip-code-origin-shipping-row").show(),$(".options-shipping-row").show(),$(".shipping-description").attr("placeholder","Melhor Envio"))})),$(".shipping-value").mask("#.##0,00",{reverse:!0}),$(".rule-shipping-value").mask("#.##0,00",{reverse:!0}),$(".rule-shipping-value").on("blur",(function(){if(1==$(this).val().length){var e="0,0"+$(this).val();$(".rule-shipping-value").val(e)}else if(2==$(this).val().length){var t="0,"+$(this).val();$(".rule-shipping-value").val(t)}})),n("#shipping-plans-add",".shipping-plans-add-container"),n("#shipping-plans-edit",".shipping-plans-edit-container"),n("#shipping-not-apply-plans-add",".shipping-not-apply-plans-add-container"),n("#shipping-not-apply-plans-edit",".shipping-not-apply-plans-edit-container"),$(".check").on("click",(function(){$(this).is(":checked")?$(this).val(1):$(this).val(0)})),t(),$(".shipping-description").keyup((function(){if($(this).val().length>60)return $(this).parent().children("#shipping-name-error").html("O campo descrição permite apenas 60 caracteres"),!1;$(this).parent().children("#shipping-name-error").html("")})),$(".shipping-info").keyup((function(){if($(this).val().length>100)return $(this).parent().children("#shipping-information-error").html("O campo tempo de entrega estimado permite apenas 100 caracteres"),!1;$(this).parent().children("#shipping-information-error").html("")})),$(".shipping-value").keyup((function(){if($.trim($(this).val()).length>8)return $(this).parent().children("#shipping-value-error").html("O campo valor permite apenas 6  caracteres"),!1;$(this).parent().children("#shipping-value-error").html("")})),$(document).on("click",".detalhes-frete",(function(){var t=$(this).attr("frete");$.ajax({method:"GET",url:"/api/project/"+e+"/shippings/"+t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){switch(e.type){case"static":$("#modal-detail-shipping #shipping-type").html("Estático");break;case"pac":$("#modal-detail-shipping #shipping-type").html("PAC - Caculado automaticamente");break;case"sedex":$("#modal-detail-shipping #shipping-type").html("SEDEX - Caculado automaticamente");break;case"melhorenvio":$("#modal-detail-shipping #shipping-type").html("MelhorEnvio - Caculado automaticamente")}$("#modal-detail-shipping .shipping-description").html(e.name),$("#modal-detail-shipping .shipping-value").html("static"!=e.type?" Calculado automaticamente":e.value),$("#modal-detail-shipping .shipping-info").html(e.information),$("#modal-detail-shipping .rule-shipping-value").html(e.rule_value),$("#modal-detail-shipping .shipping-status").html(1==e.status?'<span class="badge badge-success text-left">Ativo</span>':'<span class="badge badge-danger">Desativado</span>'),$("#modal-detail-shipping .shipping-pre-selected").html(1==e.pre_selected?'<span class="badge badge-success">Sim</span>':'<span class="badge badge-primary">Não</span>'),$("#modal-detail-shipping").modal("show")}})})),$(document).on("click",".editar-frete",(function(){var t=$(this).attr("frete");$(this).attr("frete"),$.ajax({method:"GET",url:"/api/project/"+e+"/shippings/"+t+"/edit",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){switch($("#modal-edit-shipping .shipping-id").val(e.id_code).change(),e.type){case"static":$("#modal-edit-shipping #shipping-type").prop("selectedIndex",0).change();break;case"pac":$("#modal-edit-shipping #shipping-type").prop("selectedIndex",1).change();break;case"sedex":$("#modal-edit-shipping #shipping-type").prop("selectedIndex",2).change();break;case"melhorenvio":$("#modal-edit-shipping .menv"+e.melhorenvio_integration_id).prop("selected",!0),$("#modal-edit-shipping #shipping-type").change()}$("#modal-edit-shipping .shipping-description").val(e.name),$("#modal-edit-shipping .shipping-info").val(e.information),$("#modal-edit-shipping .shipping-value").val(e.value),$("#modal-edit-shipping .rule-shipping-value").val(e.rule_value).trigger("input"),$("#modal-edit-shipping .shipping-zipcode").val(e.zip_code_origin),$("#modal-edit-shipping .shipping-status").prop("checked",!!e.status).change(),$("#modal-edit-shipping .shipping-pre-selected").prop("checked",!!e.pre_selected).change(),$("#modal-edit-shipping .shipping-receipt").prop("checked",!!e.receipt).change(),$("#modal-edit-shipping .shipping-ownhand").prop("checked",!!e.own_hand).change();var t=$("#modal-edit-shipping .shipping-plans-edit");t.html("");var i,n=[],a=_createForOfIteratorHelper(e.apply_on_plans);try{for(a.s();!(i=a.n()).done;){var p=i.value;n.push(p.id),t.append('<option value="'.concat(p.id,'">').concat(p.name+(p.description?" - "+p.description:""),"</option>"))}}catch(e){a.e(e)}finally{a.f()}t.val(n).trigger("change");var s=$("#modal-edit-shipping .shipping-not-apply-plans-edit");s.html("");var o,r=[],l=_createForOfIteratorHelper(e.not_apply_on_plans);try{for(l.s();!(o=l.n()).done;){var c=o.value;r.push(c.id),s.append('<option value="'.concat(c.id,'">').concat(c.name+(c.description?" - "+c.description:""),"</option>"))}}catch(e){l.e(e)}finally{l.f()}s.val(r).trigger("change"),$("#modal-edit-shipping").modal("show")}})})),$(document).on("click",".excluir-frete",(function(t){t.preventDefault();var n=$(this).attr("frete");$("#btn-delete-frete").unbind("click"),$("#btn-delete-frete").on("click",(function(){$.ajax({method:"DELETE",url:"/api/project/"+e+"/shippings/"+n,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){i(),alertCustom("success","Frete Removido com sucesso")}})}))})),$("#modal-create-shipping .btn-save").click((function(){var n=new FormData(document.getElementById("form-add-shipping"));$.ajax({method:"POST",url:"/api/project/"+e+"/shippings",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},data:n,processData:!1,contentType:!1,cache:!1,error:function(e){errorAjaxResponse(e)},success:function(e){alertCustom("success",e.message),i(),t()}})})),$("#modal-edit-shipping .btn-update").on("click",(function(){var t=new FormData(document.querySelector("#modal-edit-shipping #form-update-shipping"));t.set("status",$("#modal-edit-shipping .shipping-status").is(":checked")?1:0),t.set("pre_selected",$("#modal-edit-shipping .shipping-pre-selected").is(":checked")?1:0),t.set("receipt",$("#modal-edit-shipping .shipping-receipt").is(":checked")?1:0),t.set("own_hand",$("#modal-edit-shipping .shipping-ownhand").is(":checked")?1:0);var n=$("#modal-edit-shipping .shipping-id").val();$.ajax({method:"POST",url:"/api/project/"+e+"/shippings/"+n,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},data:t,processData:!1,contentType:!1,cache:!1,error:function(e){errorAjaxResponse(e)},success:function(){alertCustom("success","Frete atualizado com sucesso"),i()}})}))}));
