function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,p=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){p=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(p)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}$((function(){var e=$(window.location.pathname.split("/")).get(-1);function t(){loadOnTable("#table-order-bump tbody","#table-order-bump");var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r="/api/orderbump"+(r||""),$("#tab-order-bump-panel").find(".no-gutters").css("display","none"),$("#table-order-bump").find("thead").css("display","none"),$.ajax({method:"GET",url:r,data:{project_id:e},headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){var r=e.data,a=$("#table-order-bump tbody");if(r.length){a.html(""),$("#tab-order-bump-panel").find(".no-gutters").css("display","flex"),$("#table-order-bump").find("thead").css("display","contents");var n,o=_createForOfIteratorHelper(r);try{for(o.s();!(n=o.n()).done;){var s=n.value,p="<tr>\n                                       <td>".concat(s.description,'</td>\n                                       <td class="text-center">').concat(s.active_flag?'<span class="badge badge-success">Ativo</span>':'<span class="badge badge-danger">Desativado</span>','</td>\n                                       <td>\n                                            <div class=\'d-flex justify-content-end align-items-center\'>\n                                                <a class="pointer mg-responsive show-order-bump" data-id="').concat(s.id,'" title="Visualizar"><span class="o-eye-1"></span></a>\n                                                <a class="pointer mg-responsive edit-order-bump" data-id="').concat(s.id,'" title="Editar" ><span class="o-edit-1"></span></a>\n                                                <a class="pointer mg-responsive destroy-order-bump" data-id="').concat(s.id,'" title="Excluir" data-toggle="modal" data-target="#modal-delete-order-bump"><span class="o-bin-1"></span></a>\n                                            </div>\n                                       </td>\n                                   </tr>');a.append(p)}}catch(e){o.e(e)}finally{o.f()}pagination(e,"order-bump",t)}else a.html("\n                        <tr class=\"text-center\">\n                            <td colspan=\"3\">\n                                <div class='d-flex justify-content-center align-items-center'>\n                                    <img src='/modules/global/img/empty-state-table.svg' style='margin-right: 60px;'>\n                                    <div class='text-left'>\n                                        <h1 style='font-size: 24px; font-weight: normal; line-height: 30px; margin: 0; color: #636363;'>Nenhum order bump configurado</h1>\n                                        <p style='font-style: normal; font-weight: normal; font-size: 16px; line-height: 20px; color: #9A9A9A;'>Cadastre o seu primeiro order bump para poder\n                                        <br>gerenci√°-los nesse painel.</p>\n                                        <button type='button' style='width: auto; height: auto; padding: .429rem 1rem !important;' class='btn btn-primary add-order-bump' data-toggle=\"modal\" data-target=\"#modal-store-order-bump\">Adicionar order bump</button>\n                                    </div>\n                                </div>\n                            </td>\n                        </tr>\n                    "),a.parent().addClass("table-striped")}})}$("#tab_order_bump").on("click",(function(){t()})),$(document).on("click",".show-order-bump",(function(){var e=$(this).data("id");$.ajax({url:"/api/orderbump/"+e,headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){var t=e.data,r=t.apply_on_plans.map((function(e){return e.name+(e.description?" - ".concat(e.description):"")})).join(" / "),a=t.offer_plans.map((function(e){return e.name+(e.description?" - ".concat(e.description):"")})).join(" / ");$("#order-bump-show-table .order-bump-description").html(t.description),$("#order-bump-show-table .order-bump-discount").html(t.discount+"%"),$("#order-bump-show-table .order-bump-apply-plans").html(r),$("#order-bump-show-table .order-bump-offer-plans").html(a),$("#order-bump-show-table .order-bump-status").html(t.active_flag?'<span class="badge badge-success">Ativo</span>':'<span class="badge badge-danger">Desativado</span>'),$("#modal-show-order-bump").modal("show")}})})),$(document).on("click",".edit-order-bump",(function(){var e=$(this).data("id");$.ajax({url:"/api/orderbump/"+e,headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(t){var r=t.data,a=$("#update-apply-on-plans-order-bump"),n=$("#update-offer-plans-order-bump");$("#update-description-order-bump").val(r.description),$("#update-discount-order-bump").val(r.discount);var o=[];a.html("");var s,p=_createForOfIteratorHelper(r.apply_on_plans);try{for(p.s();!(s=p.n()).done;){var i=s.value;o.push(i.id),a.append('<option value="'.concat(i.id,'">').concat(i.name+(i.description?" - ".concat(i.description):""),"</option>"))}}catch(e){p.e(e)}finally{p.f()}a.val(o),n.html("");var c,d=[],l=_createForOfIteratorHelper(r.offer_plans);try{for(l.s();!(c=l.n()).done;){var u=c.value;d.push(u.id),n.append('<option value="'.concat(u.id,'">').concat(u.name+(u.description?" - ".concat(u.description):""),"</option>"))}}catch(e){l.e(e)}finally{l.f()}n.val(d),r.active_flag?$("#update-active-flag-order-bump").val(1).prop("checked",!0):$("#update-active-flag-order-bump").val(0).prop("checked",!1),$("#btn-update-order-bump").data("id",e),$("#modal-update-order-bump").modal("show")}})})),$("#btn-store-order-bump").on("click",(function(){var r=new FormData(document.querySelector("#form-store-order-bump"));r.append("project_id",e),$.ajax({method:"POST",url:"/api/orderbump",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:r,error:function(e){errorAjaxResponse(e)},success:function(e){alertCustom("success",e.message),$("#modal-store-order-bump").modal("hide"),$("#store-description-order-bump, #store-discount-order-bump").val(""),$("#store-apply-on-plans-order-bump, #store-offer-plans-order-bump").val(null).trigger("change"),t()}})})),$("#btn-update-order-bump").on("click",(function(){var r=$(this).data("id"),a=new FormData(document.querySelector("#form-update-order-bump"));a.append("project_id",e),$.ajax({method:"POST",url:"/api/orderbump/"+r,headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:a,error:function(e){errorAjaxResponse(e)},success:function(e){alertCustom("success",e.message),$("#modal-update-order-bump").modal("hide"),t()}})})),$(document).on("click",".destroy-order-bump",(function(e){e.preventDefault();var r=$(this).data("id");$("#btn-delete-orderbump").unbind("click"),$("#btn-delete-orderbump").on("click",(function(){$.ajax({method:"DELETE",url:"/api/orderbump/"+r,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e)},success:function(e){t(),alertCustom("success",e.message)}})}))})),$("#store-apply-on-plans-order-bump, #update-apply-on-plans-order-bump").on("select2:select",(function(){var e=$(this);e.val().length>1&&e.val().includes("all")&&e.val("all").trigger("change")}));var r={placeholder:"Nome do plano",multiple:!0,language:{noResults:function(){return"Nenhum plano encontrado"},searching:function(){return"Procurando..."},loadingMore:function(){return"Carregando mais planos..."}},ajax:{data:function(t){return{list:"plan",search:t.term,project_id:e,page:t.page||1}},method:"GET",url:"/api/plans/user-plans",delay:300,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processResults:function(e){var t=this.$element.attr("id");if(["store-apply-on-plans-order-bump","update-apply-on-plans-order-bump"].includes(t)&&1===e.meta.current_page){e.data.unshift({id:"all",name:"Qualquer plano",description:""})}return{results:$.map(e.data,(function(e){return{id:e.id,text:e.name+(e.description?" - "+e.description:"")}})),pagination:{more:e.meta.current_page!==e.meta.last_page}}}}};$("#store-apply-on-plans-order-bump, #store-offer-plans-order-bump").select2(_objectSpread({dropdownParent:$("#modal-store-order-bump")},r)),$("#update-apply-on-plans-order-bump, #update-offer-plans-order-bump").select2(_objectSpread({dropdownParent:$("#modal-update-order-bump")},r))}));
