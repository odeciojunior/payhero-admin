function _slicedToArray(a,t){return _arrayWithHoles(a)||_iterableToArrayLimit(a,t)||_unsupportedIterableToArray(a,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,t){if(a){if("string"==typeof a)return _arrayLikeToArray(a,t);var e=Object.prototype.toString.call(a).slice(8,-1);return"Object"===e&&a.constructor&&(e=a.constructor.name),"Map"===e||"Set"===e?Array.from(a):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(a,t):void 0}}function _arrayLikeToArray(a,t){(null==t||t>a.length)&&(t=a.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=a[e];return n}function _iterableToArrayLimit(a,t){var e=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=e){var n,o,r=[],s=!0,i=!1;try{for(e=e.call(a);!(s=(n=e.next()).done)&&(r.push(n.value),!t||r.length!==t);s=!0);}catch(a){i=!0,o=a}finally{try{s||null==e.return||e.return()}finally{if(i)throw o}}return r}}function _arrayWithHoles(a){if(Array.isArray(a))return a}$(document).ready((function(){var a={1:"Aprovada",2:"Pendente",3:"Recusado",4:"ChargeBack",5:"Cancelada",6:"Em processo",7:"Estornada",8:"Estorno Parcial",10:"BlackList",20:"Revisão Antifraude",21:"Cancelada Antifraude",22:"Estornado",24:"Em disputa",99:"Erro Sistema",null:"Em Processo"},t={1:"badge-success",2:"badge-pendente",3:"badge-danger",4:"badge-danger",5:"badge-danger",6:"badge-secondary",7:"badge-danger",8:"badge-warning",10:"badge-dark",20:"badge-antifraude",21:"badge-danger",22:"badge-danger",24:"badge-antifraude",99:"badge-danger",null:"badge-primary"};function e(){var a,t,e,n,o,r,s,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],c=window.location.href;c.includes("vazio"),$("#date_range").val();transaction.length>0&&(moment("2018-01-01").format("DD/MM/YYYY"),moment().format("DD/MM/YYYY"));var l={transaction:$("#transaction").val().split("#").join(""),project:null!==(a=$("#project").val())&&void 0!==a?a:"",customer:null!==(t=$("#customer").val())&&void 0!==t?t:"",customer_document:null!==(e=$("#customer_document").val())&&void 0!==e?e:"",date_range:$("#date_range").val(),date_type:null!==(n=$("#date_type").val())&&void 0!==n?n:"",order_by_expiration_date:$("#expiration_date").is(":checked")?1:0,contestation_situation:null!==(o=$("#contestation_situation").val())&&void 0!==o?o:"",is_contested:null!==(r=$("#is_contested").val())&&void 0!==r?r:"",is_expired:null!==(s=$("#is_expired").val())&&void 0!==s?s:"",sale_approve:$("#sale_approve").is(":checked")?1:0};if(i){var d="",u=!0;for(var p in l)d+="".concat(u?"":"&").concat(p,"=").concat(l[p]),u=!1;return encodeURI(d)}return l}function n(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;loadOnTable("#chargebacks-table-data","#chargebacks-table"),n=null==n?"/api/contestations/getcontestations?"+e():"/api/contestations/getcontestations"+n+"&"+e(),$.ajax({method:"GET",url:n,headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(){},success:function(e){$("#chargebacks-table-data").html(""),$("#chargebacks-table").addClass("table-striped"),$.each(e.data,(function(e,n){var o=Object.entries(n.sale_blacklist),r="";o.forEach((function(a){var t=_slicedToArray(a,2),e=(t[0],t[1]);r+="".concat(Object.keys(e)," - ").concat(Object.values(e))})),dados="",dados+="\n                                <tr ".concat("Ganha"==n.expiration_user?"class='won-contestation'":"",">\n                                    <td id='").concat(n.id,"'><span>").concat(n.sale_code,'</span></td>\n                                    <td class="line-overflow" title="').concat(n.company,'">').concat(n.company_limit,'<br><small class="text-muted">').concat(n.project,'</small></td>\n                                    <td class="line-overflow" title="').concat(n.customer,'">').concat(n.customer,'<br><small class="text-muted"> Pagamento em ').concat(n.adjustment_date,"</small></td>\n                                   "),n.sale_status in a?dados+="<td class='copy_link'>\n                                    <div class=\"d-flex justify-content-center align-items-center text-center\" >\n                                        <span class='badge ".concat(t[n.sale_status]," ").concat(10===n.sale_status?"pointer":"cursor-default",' font-size-14\' data-toggle="tooltip" data-html="true" data-placement="top" title="').concat(r,'">').concat(a[n.sale_status],"</span>\n                                        ").concat(n.sale_has_valid_tracking?'<span class="o-truck-1 font-size-20 text-success cursor-default ml-5" data-toggle="tooltip" title="Rastreamento válido"></span>':n.sale_only_digital_products?'<i class="material-icons font-size-20 text-info cursor-default ml-5" data-toggle="tooltip" title="A venda não tem produtos físicos">computer</i>':'<span class="o-truck-1 font-size-20 text-danger cursor-default ml-5" data-toggle="tooltip" title="Rastreamento inválido ou não informado"></span>',"\n                                        ").concat(n.sale_is_chargeback_recovered?'<img class="orange-gradient ml-5" src="/global/img/svg/chargeback.svg" width="20px" title="Chargeback recuperado">':"","\n                                    </div>\n                                </td>"):dados+="<td><span class='badge badge-danger'> Vazio</span></td>",dados+='\n                                    \n                                    <td class="font-size-12 bold line-overflow" style="white-space: normal;">'.concat(n.reason,"</td>\n\x3c!--                                    <td style='white-space: nowrap'><b>").concat(n.amount,"</b></td>--\x3e\n                                    <td>\n                                        ").concat(n.is_file_user_completed?'<a  role="button" class="contetation_file pointer  '+(n.has_expired?"disabled":"")+'" title="'+(n.has_expired?"Prazo para recurso encerrado":"Enviar arquivo")+'"   style="margin-right:5px" contestation="'+n.id+'"><span class="material-icons" id="check-status-text-icon" data-toggle="tooltip" title="Envio completo">done</span></a>':'<a  role="button" class="contetation_file pointer  '+(n.has_expired?"disabled":n.has_files?"text-success":"")+'" title="'+(n.has_expired?"Prazo para recurso encerrado":"Enviar arquivo")+'"   style="margin-right:5px" contestation="'+n.id+'"><span class="o-upload-to-cloud-1  '+(n.has_files?"text-success":"")+'" id="upload-file_'+n.id+' " ></span></a>',"\n                                        <a role='button' class='detalhes_venda pointer' venda='").concat(n.sale_id,'\'>\n                                            <span class="o-eye-1"></span>\n                                        </a>\n                                  </td>\n                                </tr>'),$("#chargebacks-table-data").append(dados)})),""==e.data&&$("#chargebacks-table-data").html("<tr class='text-center gray'><td colspan='10' style='vertical-align: middle;height:257px;'><img style='width:124px;margin-right:12px;' src='"+$("#chargebacks-table-data").attr("img-empty")+"' alt='Sem contestações'>Nenhuma contestação encontrada</td></tr>"),i(e),s(),$(".contestation_pdf").unbind("click"),$(".contestation_pdf").on("click",(function(a){a.preventDefault(),$("#observation").val(""),$("#pdf-modal").modal("show"),$("#update-contestation-pdf").on("click",(function(){var a=new FormData;a.append("file_contestation",$("#file_contestation")[0].files[0]),loadOnAny("#pdf-modal .modal-user-pdf-body"),$.ajax({method:"POST",url:"api/contestations/send-contestation",processData:!1,contentType:!1,data:a,headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(a){errorAjaxResponse(a)},success:function(a){$("#pdf-modal").modal("hide"),alertCustom("success",a.message)},complete:function(a){loadOnAny("#pdf-modal .modal-user-pdf-body",!0)}}),$(".icon-observation-value_"+e.data.id).addClass("green")}))}))}})}$("#date_range").val(moment().subtract(29,"days").format("DD/MM/YYYY")+" - "+moment().format("DD/MM/YYYY")).dateRangePicker(),n(),r(),loadingOnScreen(),$.ajax({method:"GET",url:"/api/projects?select=true",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(a){loadingOnScreenRemove(),errorAjaxResponse(a)},success:function(a){isEmpty(a.data)?($("#project-not-empty").hide(),$("#project-empty").show()):($("#project-empty").hide(),$("#project-not-empty").show(),$.each(a.data,(function(a,t){$("#project").append($("<option>",{value:t.id,text:t.name}))})),n()),loadingOnScreenRemove()}}),$("#bt_filtro").on("click",(function(a){a.preventDefault(),n(),r()})),$("#transaction").on("change paste keyup select",(function(){""===$(this).val()?($("#date_type").attr("disabled",!1).removeClass("disableFields"),$("#date_range").attr("disabled",!1).removeClass("disableFields")):($("#date_type").attr("disabled",!0).addClass("disableFields"),$("#date_range").attr("disabled",!0).addClass("disableFields"))})),$("#usuario").select2({placeholder:"Nome do usuário",allowClear:!0,language:{noResults:function(){return"Nenhum usuário encontrado"},searching:function(){return"Procurando..."}},ajax:{data:function(a){return{list:"user",search:a.term}},method:"POST",url:"/users/searchuser",delay:300,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processResults:function(a){return{results:$.map(a.data,(function(a){return{id:a.id,text:a.name}}))}}}}),$(".btn-light-1").click((function(){var a=$("#icon-filtro"),t=$("#text-filtro");t.fadeOut(10),"matrix(1, 0, 0, 1, 0, 0)"==a.css("transform")||"none"==a.css("transform")?(a.css("transform","rotate(180deg)"),t.text("Minimizar filtros").fadeIn()):(a.css("transform","rotate(0deg)"),t.text("Filtros avançados").fadeIn())}));var o=function(a){return a>0&&a<10?String(a).padStart(2,"0"):a};function r(){loadOnAny(".total-number",!1,{styles:{container:{minHeight:"32px",height:"auto"},loader:{width:"20px",height:"20px",borderWidth:"4px"}}});var a="/api/contestations/gettotalvalues?"+e();$.ajax({method:"GET",url:a,headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(a){loadOnAny(".total-number",!0),errorAjaxResponse(a)},success:function(a){loadOnAny(".total-number",!0),$("#total-contestation").html(o(a.total_contestation)),$("#total-contestation-tax").html(" ("+a.total_contestation_tax+" de "+a.total_sale_approved+")"),$("#total-chargeback-tax-val").html(o(a.total_chargeback)),$("#total-chargeback-tax").html(" ("+a.total_chargeback_tax+")"),$("#total-contestation-value").html(a.total_contestation_value)}})}function s(){$(".detalhes_ckargeback").unbind("click"),$(".detalhes_ckargeback").on("click",(function(a){a.preventDefault();var t=$(this).attr("ckargeback");$("#modal_titulo").html("Detalhes da contestação"),loadOnAny("#modal-details .modal-body"),$.ajax({method:"GET",url:"api/contestations/"+t,headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(a){loadOnAny("#modal-details .modal-body",!0),errorAjaxResponse(a)},success:function(a){$(".modal-body").html(""),loadOnAny("#modal-details .modal-body",!0),$(".modal-body").html(a)}})}))}function i(a){if($("#pagination").html(""),!(a.meta.total<=a.meta.per_page)){for($("#pagination").append("<button id='primeira_pagina' class='btn nav-btn'>1</button>"),"1"==a.meta.current_page&&($("#primeira_pagina").attr("disabled",!0),$("#primeira_pagina").addClass("nav-btn"),$("#primeira_pagina").addClass("active")),$("#primeira_pagina").on("click",(function(){n("?page=1")})),x=3;x>0;x--)a.meta.current_page-x<=1||($("#pagination").append("<button id='pagina_"+(a.meta.current_page-x)+"' class='btn nav-btn'>"+(a.meta.current_page-x)+"</button>"),$("#pagina_"+(a.meta.current_page-x)).on("click",(function(){n("?page="+$(this).html())})));if(1!=a.meta.current_page&&a.meta.current_page!=a.meta.last_page){var t="<button id='pagina_atual' class='btn nav-btn active'>"+a.meta.current_page+"</button>";$("#pagination").append(t),$("#pagina_atual").attr("disabled",!0),$("#pagina_atual").addClass("nav-btn"),$("#pagina_atual").addClass("active")}for(x=1;x<4;x++)a.meta.current_page+x>=a.meta.last_page||($("#pagination").append("<button id='pagina_"+(a.meta.current_page+x)+"' class='btn nav-btn'>"+(a.meta.current_page+x)+"</button>"),$("#pagina_"+(a.meta.current_page+x)).on("click",(function(){n("?page="+$(this).html())})));if("1"!=a.meta.last_page){var e="<button id='ultima_pagina' class='btn nav-btn'>"+a.meta.last_page+"</button>";$("#pagination").append(e),a.meta.current_page==a.meta.last_page&&($("#ultima_pagina").attr("disabled",!0),$("#ultima_pagina").addClass("nav-btn"),$("#ultima_pagina").addClass("active")),$("#ultima_pagina").on("click",(function(){n("?page="+a.meta.last_page)}))}}}$(document).on("keypress",(function(a){13==a.keyCode&&(n(),r())})),$("#pagination").css({marginBottom:"100px"})}));
