$((function(){var t=$(window.location.pathname.split("/")).get(-2),a=$(window.location.pathname.split("/")).get(-1);function e(){loadOnAny("#tab_info_geral .card",!1,{styles:{container:{minHeight:"250px"}}}),$.ajax({url:"/api/projects/"+t,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},success:function(t){var a=t.data;$(".title-pad").text(a.name),$("#show-photo").attr("src",a.photo?a.photo:"/modules/global/img/projeto.svg"),$("#created_at").text("Afiliado em "+a.affiliate_date),"public"===a.visibility?$("#show-visibility").text("PÃºblico").addClass("text-white details-text md p-2 pr-4 pl-4 badge-pill badge-primary"):$("#show-visibility").text("Privado").addClass("text-white details-text md p-2 pr-4 pl-4 badge-pill badge-danger"),"1"==a.status_affiliate?$("#show-status").text("Ativo").addClass("text-white details-text md p-2 pr-4 pl-4 badge-pill badge-success"):"2"==a.status_affiliate&&$("#show-status").text("Desativado").addClass("text-white details-text md p-2 pr-4 pl-4 badge-pill badge-danger"),$("#show-description").text(a.description),0==a.cookie_duration?$("#show-cookie-duration").text("Eterno"):a.cookie_duration>0&&$("#show-cookie-duration").text(a.cookie_duration+" dias"),$("#show-producer").text(a.producer),$("#show-commission").text(a.commission_affiliate+"%"),$("#show-billet-release").text(a.billet_release_days+" dias"),loadOnAny("#tab_info_geral .card",!0)},error:function(t){errorAjaxResponse(t),loadOnAny("#tab_info_geral .card",!0)}})}$("#tab-info").click((function(){e()})),$(".tab_settings_affiliate-panel").click((function(){loadOnAny("#tab_setiings_affiliate .card"),$.ajax({method:"GET",url:"/api/affiliates/"+a+"/edit",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){loadOnAny("#tab_setiings_affiliate .card",!0),errorAjaxResponse(t)},success:function(t){$("#update-project #previewimage").attr("src",t.data.project_photo?t.data.project_photo:"/modules/global/img/projeto.svg"),$("#update-project #image-logo-email").attr("src",t.data.project_logo?t.data.project_logo:"/modules/global/img/projeto.svg"),$("#update-project #contact").val(t.data.suport_contact),$("#update-project #suport_phone").val(t.data.suport_phone),loadOnAny("#tab_setiings_affiliate .card",!0)}})})),$(".toggler").on("click",(function(){var t=$(this).data("target");$(t).hasClass("show")?$(this).find(".showMore").html("add"):$(this).find(".showMore").html("remove")})),e(),$("#bt-cancel-affiliation").on("click",(function(t){t.preventDefault(),$("#modal-cancel-affiliation").modal("show"),$("#modal-cancel-affiliation .btn-cancel-affiliation").on("click",(function(){$("#modal-cancel-affiliation").modal("hide"),loadingOnScreen(),$.ajax({method:"DELETE",url:"/api/affiliates/"+a,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t),loadingOnScreenRemove()},success:function(t){loadingOnScreenRemove(),window.location="/projects"}})}))})),$("#bt-update-project").on("click",(function(t){t.preventDefault(),loadingOnScreen();var o=new FormData(document.getElementById("update-project"));$.ajax({method:"POST",url:"/api/affiliates/updateconfigaffiliate/"+a,processData:!1,contentType:!1,cache:!1,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},data:o,error:function(t){loadingOnScreenRemove(),errorAjaxResponse(t)},success:function(t){alertCustom("success",t.message),e(),loadingOnScreenRemove()}})}))}));
