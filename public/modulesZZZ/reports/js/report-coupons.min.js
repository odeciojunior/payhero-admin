var currentPage=null,_atualizar=null;$(document).ready((function(){$("#filtros").on("click",(function(){$("#div_filtros").is(":visible")?$("#div_filtros").slideUp():$("#div_filtros").slideDown()})),$("#bt_filtro").on("click",(function(t){t.preventDefault(),_atualizar()}));moment().subtract(30,"days").format("YYYY-MM-DD"),moment().format("YYYY-MM-DD");function t(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e={project:$("#projeto").val(),status:$("#status").val(),date_range:$("#date_range").val()};if(t){var a="";for(var o in e)a+="&"+o+"="+e[o];return encodeURI(a)}return e}$("#date_range").daterangepicker({startDate:moment("2018-01-01 00:00:00"),endDate:moment(),opens:"center",maxDate:moment().endOf("day"),alwaysShowCalendar:!0,showCustomRangeLabel:"Customizado",autoUpdateInput:!0,locale:{locale:"pt-br",format:"DD/MM/YYYY",applyLabel:"Aplicar",cancelLabel:"Limpar",fromLabel:"De",toLabel:"Até",customRangeLabel:"Customizado",weekLabel:"W",daysOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],firstDay:0},ranges:{Hoje:[moment(),moment()],Ontem:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Últimos 7 dias":[moment().subtract(6,"days"),moment()],"Últimos 30 dias":[moment().subtract(29,"days"),moment()],"Este mês":[moment().startOf("month"),moment().endOf("month")],"Mês passado":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")],"Vitalício":[moment("2018-01-01 00:00:00"),moment()]}},(function(t,e){t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD")})),loadingOnScreen(),$.ajax({method:"GET",url:"/api/projects?select=true",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){loadingOnScreenRemove(),errorAjaxResponse(t)},success:function(t){isEmpty(t.data)?($("#export-excel").hide(),$("#project-not-empty").hide(),$("#project-empty").show()):($("#project-empty").hide(),$("#project-not-empty").show(),$("#export-excel").show(),$.each(t.data,(function(t,e){$("#projeto").append($("<option>",{value:e.id,text:e.name}))})),_atualizar()),loadingOnScreenRemove()}}),_atualizar=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;currentPage=e;loadOnTable("#body-table-coupons",".table-coupons"),e=null==e?"/api/reports/coupons?"+t(!0).substr(1):"/api/reports/coupons"+e+t(!0),$.ajax({method:"GET",url:e,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t)},success:function(t){$("#body-table-coupons").html(""),$(".table-coupons").addClass("table-striped"),isEmpty(t.data)?$("#body-table-coupons").html("<tr class='text-center'><td colspan='10' style='vertical-align: middle;height:257px;'><img style='width:124px;margin-right:12px;' src='"+$("#body-table-coupons").attr("img-empty")+"'> Nenhum cupom encontrado</td></tr>"):($.each(t.data,(function(t,e){dados="  <tr>\n                                    <td>".concat(e.cupom_code,"</td>\n                                    <td>").concat(e.project,"</td>\n                                    <td>").concat(e.amount,"</td>\n                                </tr>"),$("#body-table-coupons").append(dados)})),$("#date").val(moment(new Date).add(3,"days").format("YYYY-MM-DD")),$("#date").attr("min",moment(new Date).format("YYYY-MM-DD"))),pagination(t,"coupons",_atualizar)}})},$(document).on("keypress",(function(t){13==t.keyCode&&_atualizar()}))}));
