function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var currentPage=null,_atualizar=null;$(document).ready((function(){$(".check").on("click",(function(){$(this).is(":checked")?$(this).val(1):$(this).val(0)})),$("#filtros").on("click",(function(){$("#div_filtros").is(":visible")?$("#div_filtros").slideUp():$("#div_filtros").slideDown()})),$("#bt_filtro").on("click",(function(t){t.preventDefault(),_atualizar()})),$(".btn-light-1").click((function(){var t=$("#icon-filtro"),e=$("#text-filtro");e.fadeOut(10),"matrix(1, 0, 0, 1, 0, 0)"==t.css("transform")||"none"==t.css("transform")?(t.css("transform","rotate(180deg)"),e.text("Minimizar filtros").fadeIn()):(t.css("transform","rotate(0deg)"),e.text("Filtros avançados").fadeIn())}));moment().subtract(30,"days").format("YYYY-MM-DD"),moment().format("YYYY-MM-DD");function t(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e={project:$("#projeto").val(),payment_method:$("#forma").val(),status:$("#status").val(),client:$("#comprador").val(),customer_document:$("#customer_document").val(),date_type:$("#date_type").val(),date_range:$("#date_range").val(),transaction:$("#transaction").val().replace("#",""),plan:$("#plan").val()};if(t){var a="";for(var n in e)a+="&"+n+"="+e[n];return encodeURI(a)}return e}function e(){loadOnAny(".number",!1,{styles:{container:{minHeight:"32px",height:"auto"},loader:{width:"20px",height:"20px",borderWidth:"4px"}}}),$.ajax({method:"GET",url:"/api/reports/blockedresume",data:t(),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){loadOnAny(".number",!0),errorAjaxResponse(t)},success:function(t){loadOnAny(".number",!0),$("#total_sales").text("0"),$("#commission_blocked, #total").html('R$ <span class="font-size-30 bold">0,00</span>'),t.total_sales&&($("#total_sales, #commission_blocked, #total").text(""),$("#total_sales").html(t.total_sales),$("#commission_blocked").html('R$ <span class="font-size-30 bold">'.concat(t.commission,"</span>")),$(".blocked-balance-icon").attr("title","Saldo bloqueado de convites: R$ "+t.commission_invite).tooltip({placement:"bottom"}),$(".blocked-balance-icon").attr("data-original-title","Saldo bloqueado de convites: R$ "+t.commission_invite).tooltip({placement:"bottom"}),$("#total").html('R$ <span class="font-size-30 bold">'.concat(t.total,"</span>")))}})}$("#date_range").daterangepicker({startDate:moment("2018-01-01 00:00:00"),endDate:moment(),opens:"center",maxDate:moment().endOf("day"),alwaysShowCalendar:!0,showCustomRangeLabel:"Customizado",autoUpdateInput:!0,locale:{locale:"pt-br",format:"DD/MM/YYYY",applyLabel:"Aplicar",cancelLabel:"Limpar",fromLabel:"De",toLabel:"Até",customRangeLabel:"Customizado",weekLabel:"W",daysOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],firstDay:0},ranges:{Hoje:[moment(),moment()],Ontem:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Últimos 7 dias":[moment().subtract(6,"days"),moment()],"Últimos 30 dias":[moment().subtract(29,"days"),moment()],"Este mês":[moment().startOf("month"),moment().endOf("month")],"Mês passado":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")],"Vitalício":[moment("2018-01-01 00:00:00"),moment()]}},(function(t,e){t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD")})),loadingOnScreen(),$.ajax({method:"GET",url:"/api/projects?select=true",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){loadingOnScreenRemove(),errorAjaxResponse(t)},success:function(t){isEmpty(t.data)?($("#export-excel").hide(),$("#project-not-empty").hide(),$("#project-empty").show()):($("#project-empty").hide(),$("#project-not-empty").show(),$("#export-excel").show(),$.each(t.data,(function(t,e){$("#project").append($("<option>",{value:e.id,text:e.name}))})),_atualizar()),loadingOnScreenRemove()}}),_atualizar=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;currentPage=a;var n=!0;loadOnTable("#dados_tabela","#tabela_vendas"),null==a?a="/api/reports/blockedbalance?"+t(!0).substr(1):(a="/api/reports/blockedbalance"+a+t(!0),n=!1),$.ajax({method:"GET",url:a,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t)},success:function(t){var e;$("#dados_tabela").html(""),$("#tabela_vendas").addClass("table-striped");var a=(_defineProperty(e={1:"success",6:"primary",7:"danger",8:"warning",4:"danger",3:"danger",2:"pendente",20:"antifraude",12:"success"},"20","antifraude"),_defineProperty(e,22,"danger"),_defineProperty(e,23,"warning"),_defineProperty(e,24,"antifraude"),e);isEmpty(t.data)?$("#dados_tabela").html("<tr class='text-center'><td colspan='10' style='vertical-align: middle;height:257px;'><img style='width:124px;margin-right:12px;' src='"+$("#dados_tabela").attr("img-empty")+"'>Nenhuma venda encontrada</td></tr>"):($.each(t.data,(function(t,e){var n="";e.start_date&&(n="<strong class='bold-mobile'>"+(n=e.start_date.split(/\s/g))[0]+" </strong> <br> <small class='gray font-size-12'>"+n[1]+" </small>");var o="";e.end_date&&(o="<strong class='bold-mobile'>"+(o=e.end_date.split(/\s/g))[0]+" </strong> <br> <small class='gray font-size-12'>"+o[1]+" </small>"),dados="  <tr>\n                                    <td class='display-sm-none display-m-none display-lg-none text-center text-left font-size-14'>\n                                        ".concat(e.sale_code,"\n                                        ").concat(e.upsell?'<span class="text-muted font-size-10">(Upsell)</span>':"",'\n                                    </td>\n                                    <td class="text-left font-size-14">').concat(e.project,'</td>\n                                    <td class="text-left font-size-14">').concat(e.product).concat(null!=e.affiliate&&"producer"==e.user_sale_type?"<br><small>(Afiliado: ".concat(e.affiliate,")</small>"):"","</td>\n                                    <td class='display-sm-none display-m-none display-lg-none text-left font-size-14'>").concat(e.client,"</td>\n                                    <td>\n                                        <img src='/modules/global/img/cartoes/").concat(e.brand,".png'  style='width: 45px'>\n                                    </td>\n                                    <td>\n                                       <div class=\"d-flex align-items-center\">\n                                            <span class=\"badge badge-").concat(a[e.status]," ").concat("Pendente"===e.status_translate?"boleto-pending":"",'" ').concat("Pendente"===e.status_translate?'status="'+e.status_translate+'" sale="'+e.id_default+'"':"",">").concat(e.status_translate,"</span>\n                                               ").concat(e.is_chargeback_recovered&&"Aprovado"===e.status_translate?'\n                                                <img class="orange-gradient ml-10" width="20px" src="/modules/global/img/svg/chargeback.svg" title="Chargeback recuperado">':"","\n                                        </div>\n                                    </td>\n                                    <td class='display-sm-none text-left font-size-14 display-m-none'>").concat(n,"</td>\n                                    <td class='display-sm-none text-left font-size-14'>").concat(o,"</td>\n                                    <td style='white-space: nowrap' class=\"text-left font-size-14\"><b>").concat(e.total_paid,'</b></td>\n                                    <td class="text-left font-size-14">\n                                        ').concat(e.reason_blocked,"\n                                    </td>\n                                </tr>"),$("#dados_tabela").append(dados)})),$("#date").val(moment(new Date).add(3,"days").format("YYYY-MM-DD")),$("#date").attr("min",moment(new Date).format("YYYY-MM-DD"))),pagination(t,"sales",_atualizar)}}),n&&e()},$("#project").on("change",(function(){$(this).val();$("#plan").val(null).trigger("change")})),$("#plan").select2({placeholder:"Nome do plano",allowClear:!0,language:{noResults:function(){return"Nenhum plano encontrado"},searching:function(){return"Procurando..."}},ajax:{data:function(t){return{list:"plan",search:t.term,project_id:$("#project").val()}},method:"GET",url:"/api/sales/user-plans",delay:300,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processResults:function(t){return{results:$.map(t.data,(function(t){return{id:t.id,text:t.name+(t.description?" - "+t.description:"")}}))}}}}),$(document).on("keypress",(function(t){13==t.keyCode&&_atualizar()}))}));
