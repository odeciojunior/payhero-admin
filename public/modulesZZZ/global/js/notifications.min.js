$(document).ready((function(){a();var o=new Pusher("ee4529bae28bb85defaf",{cluster:"us2",forceTLS:!0});function a(){$.ajax({method:"GET",url:"/api/notifications/unreadamount",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(){},success:function(o){parseInt(o.qtd_notification)>0?($("#notification-amount").removeClass("badge-notification-false"),$("#notification-amount").addClass("badge-notification")):($("#notification-amount").removeClass("badge-notification"),$("#notification-amount").addClass("badge-notification-false")),$("#notificationBadge").html("New "+o.qtd_notification)}})}Pusher.logToConsole=!1,o.subscribe("channel-"+$("#user").val()).bind("new-notification",(function(o){alertCustom("success",o.message),a()})),$("#notification").on("click",(function(){$("#notificationTemplate").css({height:"150px"}),loadOnNotification("#notificationTemplate"),$.ajax({method:"GET",url:"/api/notifications/unread",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(){},success:function(o){$("#notificationTemplate").html(""),$("#notificationTemplate").css({height:"300px","overflow-y":"scroll"}),$(o.data).length>0?$(o.data).each((function(o,a){$("#notificationTemplate").append(function(o){return'<a class="list-group-item dropdown-item item-notification d-flex flex-row justify-content-around align-self-center" href='+(o=function(o){var a="",e="",n="",i="",t="";switch(o.type){case"BoletoCompensatedNotification":a=o.message+(o.message>1?" boletos compensados":" boleto compensado"),e="o-currency-1",n="color:#5EE2A1;",i="background: #E2FFF1;",t="/sales";break;case"DomainApprovedNotification":a=o.message,e="o-clouds-1",n="color:#5EE2A1;",i="background: #E2FFF1;",t="/projects";break;case"ReleasedBalanceNotification":a=o.message,e="o-money-bag-1",n="color:#5EE2A1;",i="background: #E2FFF1;",t="/finances";break;case"SaleNotification":a=o.message+(o.message>1?" novas vendas":" nova venda"),e="o-checkout-cart-1",n="color:#5EE2A1;",i="background: #E2FFF1;",t="/sales";break;case"ShopifyIntegrationReadyNotification":case"UserShopifyIntegrationStoreNotification":a=o.message,e="o-checked-circle-1",n="color:#5EE2A1;",i="background: #E2FFF1;",t="/projects";break;case"WithdrawalApprovedNotification":a=o.message,e="o-cash-dispenser-1",n="color:#5EE2A1;",i="background: #E2FFF1;",t="/finances";break;case"TrackingsImportedNotification":a=o.message,e="o-config-1",n="color:#5EE2A1;",i="background: #E2FFF1;",t="/trackings";break;case"SalesExportedNotification":a="Exportação do relatório de vendas concluída.",e="o-sales-up-1",n="color:#2E85EC;",i="background: #D5F6FF;",t="/sales/download/"+o.message;break;case"TrackingsExportedNotification":a="Exportação do relatório de códigos de rastreio concluída.",e="o-config-1",n="color:#5EE2A1;",i="background: #E2FFF1;",t="/trackings/download/"+o.message;break;case"WithdrawalBlockedNotification":a="O saque está bloqueado. Entre em contato com o suporte para mais informações.",e="o-money-bag-1",n="color:#f41c1c;",i="background: #E2FFF1;",t="/finances"}if(1==o.read)var c="";else c="background-color:#F2FFF9";return{message:a,iconClass:e,iconColor:n,iconBackgroundColor:i,link:t,time:o.time,background:c}}(o)).link+" role=\"menuitem\" id='item-notification' style='"+o.background+"'>\n\n                        <div class=\"mr-10 icon-notification d-flex justify-content-center align-self-center align-items-center\" style='"+o.iconBackgroundColor+"'>\n                            <span class='"+o.iconClass+"' style='"+o.iconColor+'\'></span>\n                        </div>\n                        <div class="media-body description-notification">\n                            <h6 class="media-heading" style=\'white-space:normal\'>\n                                '+o.message+'\n                            </h6>\n                            <time class="media-meta"> '+o.time+"</time>\n                        </div>\n                </a>"}(a))})):$("#notificationTemplate").html("<div style='vertical-align middle;max-height:100px;padding-top:12%' class='text-center'><img src='"+$("#notificationTemplate").attr("img-empty")+"'><br> Nenhuma notificação por aqui.</div>"),$.ajax({method:"POST",url:"/api/notifications/markasread",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(){},success:function(o){a()}})}})}))}));
