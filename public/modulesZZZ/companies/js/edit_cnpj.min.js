function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,c=e},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw c}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var companyStatus={pending:"badge badge-primary",analyzing:"badge badge-pending",approved:"badge badge-success",refused:"badge badge-danger"},companyStatusTranslated={pending:"Pendente",analyzing:"Em análise",approved:"Aprovado",refused:"Recusado"},companyTypeDocument={bank_document_status:"Comprovante de extrato bancário",address_document_status:"Comprovante de endereço",contract_document_status:"Comprovante de contrato social"},gatewayTax={"plan-2":6.9,"plan-15":6.5,"plan-30":5.9},initForm=null,htmlTable=null;$(document).ready((function(){var e,t,a,n,o=$("#redirect_back_link"),c=$("#company_update_form"),r=$("#company_bank_update_form"),s=$("#company_bank_routing_number_form");e=extractIdFromPathName(),t=$(location).attr("origin"),a=t+"/companies",n=t+"/api/companies",o.attr("href",a),c.attr("action",n+"/"+e),r.attr("action",n+"/"+e),s.attr("action",n+"/"+e),2==window.location.search.split("&").length&&"tab=documents"==window.location.search.split("&")[1]&&($("#company-nav").removeClass("active"),$("#tab_user").removeClass("active"),$("#tab_documentos").addClass("active"),$("#documents-nav").addClass("active")),$(".check").on("change",(function(){$(this).is(":checked")?$(this).val(1):$(this).val(0)}));var d="";initForm=function(){var e=extractIdFromPathName();$.ajax({method:"GET",url:"/api/companies/"+e,dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e),$("#dropzone").css("display","block")},success:function(t){var a=t.company,n=t.banks;if(d=a.id_code,a.user_code,$("#company_id").val(a.id_code),$("#fantasy_name").val(a.fantasy_name),$("#company_document").val(a.document),$("#support_email").val(a.support_email),$("#support_telephone").val(a.support_telephone),$("#zip_code").val(a.zip_code),$("#street").val(a.street),$("#number").val(a.number),$("#neighborhood").val(a.neighborhood),$("#complement").val(a.complement),$("#state").val(a.state),$("#city").val(a.city),$("#country").val(a.country),$("#document_issue_date").val(a.document_issue_date),$("#document_issuer").val(a.document_issuer),$("#document_issuer_state").val(a.document_issuer_state),$("#document_number").val(a.extra_document),companyIsApproved(a)&&($("#tax-payment").val(a.gateway_tax+"%"),$(".select-gateway-tax").html(""),$(".select-gateway-tax").append('\n                        <select id="gateway-release-payment" class="form-control">\n                            <option value="plan-2" '.concat(2==a.gateway_release_money_days?"selected":"","> Após postagem de rastreio válida (taxa de ").concat(2==a.gateway_release_money_days?a.gateway_tax:"6.9",'%)</option>\n                            <option value="plan-15" ').concat(15==a.gateway_release_money_days?"selected":"",">15 dias (taxa de ").concat(15==a.gateway_release_money_days?a.gateway_tax:"6.5",'%)</option>\n                            <option value="plan-30" ').concat(30==a.gateway_release_money_days?"selected":"",">30 dias (taxa de ").concat(30==a.gateway_release_money_days?a.gateway_tax:"5.9","%)</option>\n                        </select>\n                    ")),$(".gateway-tax").removeAttr("hidden"),$("#nav_tax_gateways").removeAttr("hidden")),a.has_project&&($("#active_flag").attr("disabled",!0),$("#active_flag").css("cursor","not-allowed"),$(".switch").css("cursor","not-allowed"),$(".slider").css("cursor","not-allowed"),$(".switch").css("opacity","0.5")),$("#active_flag").val(a.active_flag),a.active_flag?$("#active_flag").attr("checked","checked"):$("#active_flag").attr("checked",!1),"usa"===a.country)$("#rounting_number").val(a.bank).trigger("input"),$("#account_routing_number").val(a.account),$("#company_bank_update_form").hide(),$("#company_bank_routing_number_form").show();else{if("brazil"===a.country||"portugal"===a.country){var o,c=_createForOfIteratorHelper(n);try{for(c.s();!(o=c.n()).done;){var r=o.value;$("#bank").append('<option value="'.concat(r.code,'" ').concat(r.code===a.bank?"selected":"",">").concat(r.code," - ").concat(r.name,"</option>"))}}catch(e){c.e(e)}finally{c.f()}}else $(".div-bank").html(""),$(".div-bank").append('<label for="bank">Banco</label><input id="bank" name="bank"  value="'.concat(a.bank,'" class="input-pad" placeholder="Nome do banco">'));$("#agency").val(a.agency),$("#agency_digit").val(a.agency_digit),$("#account").val(a.account),$("#account_digit").val(a.account_digit),$("#account_type").val(a.account_type)}"brazil"===a.country?$("#agency").attr("maxlength","4"):$("#agency").attr("maxlength","20"),function(e){"Aprovado"===companyStatusTranslated[e.bank_document_status]?$("#details-document-person-juridic-bank-document").hide():$("#details-document-person-juridic-bank-document").show(),"Aprovado"===companyStatusTranslated[e.address_document_status]?($(".info-complemented").attr("disabled","disabled"),$("#details-document-person-juridic-address").hide()):($(".info-complemented").removeAttr("disabled"),$("#details-document-person-juridic-address").show()),"Aprovado"===companyStatusTranslated[e.contract_document_status]?($("#company_document").attr("disabled","disabled"),$("#fantasy_name").attr("disabled","disabled"),$("#details-document-person-juridic-contract").hide()):($("#company_document").removeAttr("disabled"),$("#details-document-person-juridic-contract").show()),"Pendente"===companyStatusTranslated[e.bank_document_status]||"Recusado"===companyStatusTranslated[e.bank_document_status]||"Pendente"===companyStatusTranslated[e.address_document_status]||"Recusado"===companyStatusTranslated[e.address_document_status]||"Pendente"===companyStatusTranslated[e.contract_document_status]||"Recusado"===companyStatusTranslated[e.contract_document_status]?$("#text-alert-documents").show():$("#text-alert-documents").hide()}(a),$("#td-bank-status").html("").append("\n                    <span class='badge ".concat(companyStatus[a.bank_document_status],"'>\n                        ").concat(companyStatusTranslated[a.bank_document_status],"\n                    </span>\n                ")),$("#td-address-status").html("").append("\n                    <span class='badge ".concat(companyStatus[a.address_document_status],"'>\n                        ").concat(companyStatusTranslated[a.address_document_status],"\n                    </span>\n                    ")),$("#td-contract-status").html("").append("\n                    <span class='badge ".concat(companyStatus[a.contract_document_status],"'>\n                        ").concat(companyStatusTranslated[a.contract_document_status],"\n                    </span>\n                ")),function(e){3==e.address_document_status&&3==e.bank_document_status&&3==e.contract_document_status&&($(".form-basic-informations :input[type=text]").attr("disabled",!0),$(".dz-hidden-input").prop("disabled",!0),$("#dropzoneDocuments").css({cursor:"not-allowed"}),$(".text-dropzone").css({cursor:"not-allowed"}))}(a),function(e){""==e.zip_code||""==e.street||""==e.number||""==e.neighborhood||""==e.state||""==e.city||""==e.country?($("#row_dropzone_documents").hide(),$("#div_address_pending").show()):($("#row_dropzone_documents").show(),$("#div_address_pending").hide())}(a),"brazil"!=a.country&&"usa"!=a.country||$(".div-state").show(),function(e){"brazil"==e.country?($("#zip_code").mask("00000-000"),$("#support_telephone").mask("+55 (00) 0000-00009"),$("#company_document").mask("00.000.000/0000-00"),$("#zip_code").on("input",(function(){var e=$("#zip_code").val().replace(/[^0-9]/g,"");if(8!==e.length)return!1;$.ajax({url:"https://viacep.com.br/ws/"+e+"/json/",type:"GET",cache:!1,async:!1,success:function(e){e.localidade&&$("#city").val(unescape(e.localidade)),e.bairro&&$("#neighborhood").val(unescape(e.bairro)),e.uf&&$("#state").val(unescape(e.uf)),e.logradouro&&$("#street").val(unescape(e.logradouro))}})}))):$("#support_telephone").mask("+0#")}(a),function(e){var t={brazil:"CNPJ",portugal:"NIPC",usa:"EIN",germany:"NIF",spain:"CIF",france:"SIRET",italy:"Partita IVA",unitedkingdom:"CNPJ"};$(".label-document").text(t[e.country]),$("#company_document").attr("placeholder",t[e.country])}(a),$(".document-url").on("click",(function(e){e.preventDefault();var t=$(this).attr("href");loadingOnScreen(),$.ajax({method:"POST",url:"/api/companies/opendocument",dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},data:{document_url:t},error:function(e){loadingOnScreenRemove(),errorAjaxResponse(e)},success:function(e){loadingOnScreenRemove(),window.open(e.data,"_blank")}})})),$(".details-document-person-juridic").on("click",(function(){$("#document-type").val(""),$("#modal-title-document-person-juridic").html(""),$("#document-type").val($(this).data("document")),$("#modal-title-document-person-juridic").html("".concat(companyTypeDocument[$(this).data("document")])),$("#modal-document-person-juridic").modal("show"),Dropzone.forElement("#dropzoneDocumentsJuridicPerson").removeAllFiles(!0),function(e){loadOnTable("#table-body-document-person-juridic","#table-document-person-juridic"),$.ajax({method:"POST",url:"/api/companies/".concat(e,"/getdocuments"),data:{document_type:$("#document-type").val()},dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e),$("#loaderLine").remove()},success:function(t){$("#loaderLine").remove(),htmlTable(t.data),$("#company-id").val(e),$("#dropzone").css("display","block"),$("#modal-document-person-fisic").modal("show")}})}(e)})),$("#gateway-release-payment").on("change",(function(){$("#tax-payment").val(gatewayTax[$(this).val()]+"%")})),$("#tab_tax_gateways  #transaction-tax").html(a.transaction_tax).attr("disabled","disabled"),$("#tab_tax_gateways #installment-tax").html(a.installment_tax).attr("disabled","disabled")}})},initForm(),$("#update_payment_tax_cnpj").unbind("click"),$("#update_payment_tax_cnpj").on("click",(function(){loadingOnScreen(),$.ajax({method:"POST",url:"/api/companies/".concat(d,"/updatetax"),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},data:{gateway_release_payment:$("#gateway-release-payment").val()},error:function(e){loadingOnScreenRemove(),errorAjaxResponse(e)},success:function(e){loadingOnScreenRemove(),alertCustom("success",e.message),$("#tax-payment").val(e.data.new_gateway_tax+"%"),initForm()}})})),$("#rounting_number").on("input",(function(){var e=$(this).val();9!==e.length||isNaN(parseInt(e))?$("#bank_routing_number").val("Digite um routing number válido..."):$.ajax({url:"https://www.routingnumbers.info/api/data.json?rn="+$(this).val(),success:function(e){isEmpty(e.customer_name)?$("#bank_routing_number").val("Digite um routing number válido..."):$("#bank_routing_number").val(e.customer_name)},error:function(e){$("#bank_routing_number").val("Digite um routing number válido..."),alertCustom("error","Erro ao buscar routing number")}})})),c.on("submit",(function(e){e.preventDefault(),$("#company_document").remove("disabled"),$(".info-complemented").removeAttr("disabled"),$("#country").removeAttr("disabled");var t=new FormData(document.getElementById("company_update_form"));$("#country").attr("disabled",!0),$("#active_flag").is(":checked")||t.append("active_flag","0"),loadingOnScreen(),$.ajax({method:"POST",url:c.attr("action"),headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:t,error:function(e){errorAjaxResponse(e),loadingOnScreenRemove()},success:function(e){alertCustom("success",e.message),loadingOnScreenRemove(),initForm()}})})),r.on("submit",(function(e){e.preventDefault();var t=new FormData(document.getElementById("company_bank_update_form"));loadingOnScreen(),$.ajax({method:"POST",url:r.attr("action"),headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:t,error:function(e){errorAjaxResponse(e)},success:function(e){loadingOnScreenRemove(),alertCustom("success",e.message),initForm()}})})),s.on("submit",(function(e){e.preventDefault();var t=new FormData(document.getElementById("company_bank_routing_number_form"));loadingOnScreen(),$.ajax({method:"POST",url:s.attr("action"),headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},processData:!1,contentType:!1,cache:!1,data:t,error:function(e){errorAjaxResponse(e)},success:function(e){loadingOnScreenRemove(),alertCustom("success",e.message),initForm()}})})),$("#agency").on("input",(function(){$(this).val($(this).val().replace(/[^a-z0-9]/gi,""))})),$("#account").on("input",(function(){$(this).val($(this).val().replace(/[^a-z0-9]/gi,""))})),htmlTable=function(e){$("#loaderLine").remove();var t="";$("#table-body-document-person-juridic").html(""),0==e.length?$("#table-body-document-person-juridic").append('<tr><td class="text-center" colspan="4">Nenhum documento enviado</td></tr>'):($("#table-body-document-person-juridic").html(""),$.each(e,(function(e,a){t="\n                    <tr>\n                        <td class='text-center'>".concat(a.date,"</td>\n                        <td class='text-center' style='cursor: pointer;'>\n                            <span class='badge ").concat(companyStatus[a.status],"'>\n                                ").concat(companyStatusTranslated[a.status],"\n                            </span>\n                        </td>"),""!=a.refused_reason&&null!=a.refused_reason?t+="<td class='text-center' style='color: red;'>".concat(a.refused_reason,"</td>"):t+="<td class='text-center' style='color:red;'></td>",t+="\n                    <td class='text-center'>\n                        <a href='".concat(a.document_url,"' target='_blank' role='button' class='detalhes_document'><span class=\"o-eye-1\"></span></a>\n                    </td>\n                    </tr>\n                "),$("#table-body-document-person-juridic").append(t)})))}})),Dropzone.autoDiscover=!1;var myDropzone=new Dropzone("#dropzoneDocumentsJuridicPerson",{headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},paramName:"file",maxFilesize:2,url:"/api/companies/uploaddocuments",acceptedFiles:".jpg,.jpeg,.doc,.pdf,.png",previewsContainer:".dropzone-previews",success:function(e,t){if(alertCustom("success",t.message),e.previewElement)return e.previewElement.classList.add("dz-success")},error:function(e,t){"Max filesize"==t?errorAjaxResponse("O documento é muito grande. Tamanho maximo: 2mb."):"upload files of this type"==t?errorAjaxResponse("O documento deve estar em um dos seguintes formatos: jpeg, jpg, png."):errorAjaxResponse(t),myDropzone.removeFile(e)},complete:function(){loadOnTable("#table-body-document-person-juridic","#table-document-person-juridic");var e=extractIdFromPathName();$.ajax({method:"POST",url:"/api/companies/".concat(e,"/getdocuments"),data:{document_type:document.querySelector("#document-type").value},dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(e){errorAjaxResponse(e),$("#loaderLine").remove()},success:function(e){htmlTable(e.data),initForm()}})}});
