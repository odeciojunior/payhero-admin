$(document).ready((function(){$("#progress-bar-register").css("width","16%");var e="";$("#phone").mask("(00) 0000-00009"),$("#support_telephone").mask("(00) 0000-00009"),$("#document").mask("000.000.000-00"),$("#zip_code").mask("99.999-999"),$("#zip_code_company").mask("99.999-999"),$("#company_document").mask("00.000.000/0000-00"),$("#number").mask("0#"),$("#agency").mask("0#"),$("#agency_digit").mask("0#"),$("#account").mask("0#"),$("#account_digit").mask("0#"),$("#number_company").mask("0#"),$("#bank").select2();var r="basic data";function o(){$("#bankError").css("display","none"),$("#agencyError").css("display","none"),$("#accountError").css("display","none");var e=!0;return""==$("#bank").val()&&($("#bankError").show(),e=!1),$("#agency").val().length<1&&($("#agencyError").show(),e=!1),$("#account").val().length<1&&($("#accountError").show(),e=!1),e}function n(){location.href="/dashboard"}function a(e,r){swal({position:"top-right",type:e,toast:"true",title:r,showConfirmButton:!1,timer:6e3})}$("#password").keyup((function(){$("#passwordError").hide()})),$("#email").keyup((function(){$("#emailError").hide()})),$("#btnBrasil").on("click",(function(){$("#country").val("brasil")})),$("#btnUSA").on("click",(function(){$("#country").val("usa")})),$("#btn-go").click((function(t){switch(t.preventDefault(),loadingOnScreen(),r){case"basic data":!function(){if(!function(){var e=!0;moment(),$("#nameError").css("display","none"),$("#lastNameError").css("display","none"),$("#emailError").css("display","none"),$("#phoneError").css("display","none"),$("#documentError").css("display","none"),$("#documentExistError").css("display","none"),$("#documentInvalidError").css("display","none"),$("#dateBirthError").css("display","none"),$("#dateBirthIncorrect").css("display","none"),$("#firstname").val().length<3&&($("#nameError").show(),e=!1);$("#lastname").val().length<3&&($("#lastNameError").show(),e=!1);$("#phone").val().replace(/[^0-9]/g,"").length<10&&($("#phoneError").show(),e=!1);var r=$("#document").val().replace(/[^0-9]/g,"");if($("#document").val().replace(/[^0-9]/g,"").length<1)$("#documentError").show(),$("#documentInvalidError").hide(),$("#documentExistError").hide(),e=!1;else if(function(e){if(11==e.length){var r=[];return r[0]=1*e[0]+2*e[1]+3*e[2],r[0]+=4*e[3]+5*e[4]+6*e[5],r[0]+=7*e[6]+8*e[7]+9*e[8],r[0]=r[0]%11,r[0]=r[0]%10,r[1]=1*e[1]+2*e[2]+3*e[3],r[1]+=4*e[4]+5*e[5]+6*e[6],r[1]+=7*e[7]+8*e[8]+9*r[0],r[1]=r[1]%11,r[1]=r[1]%10,r[0]==e[9]&&r[1]==e[10]}return!1}(r)){(function(e){var r="";return $.ajax({method:"GET",url:"/api/register/verify-cpf",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{document:e},async:!1,error:function(e){},success:function(e){r="true"==e.cpf_exist}}),r})($("#document").val())?($("#documentError").hide(),$("#documentInvalidError").hide(),$("#documentExistError").show(),e=!1):($("#documentError").hide(),$("#documentInvalidError").hide(),$("#documentExistError").hide())}else $("#documentInvalidError").show(),$("#documentError").hide(),$("#documentExistError").hide(),e=!1;$("#date_birth").val().replace(/[^0-9]/g,"").length>8?($("#dateBirthIncorrect").show(),e=!1):0===$("#date_birth").val().replace(/[^0-9]/g,"").length&&($("#dateBirthError").show(),e=!1);return e}())return a("error","Revise os dados informados"),loadingOnScreenRemove(),!1;loadingOnScreenRemove(),r="password",$(".div1").hide(),$(".div2").show(),$("#progress-bar-register").css("width","32%")}();break;case"password":!function(){if(!function(){var e=!0,r=/[\(\)\<\>\,\;\:\\\/\"\[\]]/;if(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test($("#email").val())||$("#email").val().match(r)||-1!==$("#email").val().indexOf(" "))$("#emailError").show(),$("#emailExistError").hide(),e=!1;else{(function(e){var r="";return $.ajax({method:"GET",url:"/api/register/verify-email",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{email:e},async:!1,error:function(e){},success:function(e){r="true"==e.email_exist}}),r})($("#email").val())?($("#emailError").hide(),$("#emailExistError").show(),e=!1):($("#emailError").hide(),$("#emailExistError").hide())}$("#password").val().replace(/[^0-9]/g,"").length<1&&($("#passwordError").show(),e=!1);$("#password").val().length<8&&($("#passwordError").show(),e=!1);$("#password").val().replace(/[^a-zA-Z]/g,"").length<1&&($("#passwordError").show(),e=!1);return e}())return a("error","Revise os dados informados"),loadingOnScreenRemove(),!1;loadingOnScreenRemove(),r="residential data",$(".div2").hide(),$(".div3").show(),$("#progress-bar-register").css("width","48%")}();break;case"residential data":!function(){if(!function(){var e=!0;$("#zipCodeError").css("display","none"),$("#streetError").css("display","none"),$("#numberError").css("display","none"),$("#neighborhoodError").css("display","none"),$("#complementError").css("display","none"),$("#cityError").css("display","none"),$("#stateError").css("display","none"),$("#zip_code").val().replace(/[^0-9]/g,"").length<8&&($("#zipCodeError").show(),e=!1);$("#street").val().length<3&&($("#streetError").show(),e=!1);$("#number").val().length<1&&($("#numberError").show(),e=!1);$("#neighborhood").val().length<3&&($("#neighborhoodError").show(),e=!1);$("#city").val().length<2&&($("#cityError").show(),e=!1);$("#state").val().length<1&&($("#stateError").show(),e=!1);return e}())return a("error","Revise os dados informados"),loadingOnScreenRemove(),!1;loadingOnScreenRemove(),r="company data",$(".div3").hide(),$(".div4").show(),$("#btn-go").hide(),$("#alert-row").show(),$("#progress-bar-register").css("width","64%")}();break;case"company data":!function(){if(!function(){$("#companyDocumentError").css("display","none"),$("#fantasyNameError").css("display","none"),$("#supportEmailError").css("display","none"),$("#supportTelephoneError").css("display","none");var e=!0;if($("#company_document").val().replace(/[^0-9]/g,"").length<14)$("#companyDocumentError").show(),$("#companydocumentExistError").hide(),e=!1;else{(function(e){var r="";return $.ajax({method:"GET",url:"/api/register/verify-cnpj",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{company_document:e},async:!1,error:function(e){},success:function(e){r="true"==e.cnpj_exist}}),r})($("#company_document").val())?($("#companyDocumentError").hide(),$("#companydocumentExistError").show(),e=!1):($("#companyDocumentError").hide(),$("#companydocumentExistError").hide())}$("#fantasy_name").val().length<3&&($("#fantasyNameError").show(),e=!1);var r=/[\(\)\<\>\,\;\:\\\/\"\[\]]/;/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test($("#support_email").val())&&!$("#support_email").val().match(r)&&-1===$("#support_email").val().indexOf(" ")||($("#supportEmailError").show(),e=!1);$("#support_telephone").val().replace(/[^0-9]/g,"").length<10&&($("#supportTelephoneError").show(),e=!1);return e}())return a("error","Revise os dados informados"),loadingOnScreenRemove(),!1;loadingOnScreenRemove(),r="residential data company",$(".div4").hide(),$(".div7").show(),$("#btn-go").show(),$("#alert-row").hide(),$("#progress-bar-register").css("width","80%")}();break;case"residential data company":!function(){if(!function(){var e=!0;$("#zipCodeCompanyError").css("display","none"),$("#streetCompanyError").css("display","none"),$("#numberCompanyError").css("display","none"),$("#neighborhoodCompanyError").css("display","none"),$("#stateCompanyError").css("display","none"),$("#cityCompanyError").css("display","none"),$("#zip_code_company").val().replace(/[^0-9]/g,"").length<8&&($("#zipCodeCompanyError").show(),e=!1);$("#street_company").val().length<3&&($("#streetCompanyError").show(),e=!1);$("#number_company").val().length<1&&($("#numberCompanyError").show(),e=!1);$("#neighborhood_company").val().length<3&&($("#neighborhoodCompanyError").show(),e=!1);$("#city_company").val().length<2&&($("#cityCompanyError").show(),e=!1);$("#state_company").val().length<1&&($("#stateCompanyError").show(),e=!1);return e}())return a("error","Revise os dados informados"),loadingOnScreenRemove(),!1;loadingOnScreenRemove(),r="bank data juridical person",loadingOnScreenRemove(),$(".div7").hide(),$(".div5").show(),$("#btn-go").show(),$("#progress-bar-register").css("width","91%")}();break;case"bank data juridical person":!function(){if(!o())return a("error","Revise os dados informados"),loadingOnScreenRemove(),!1;loadingOnScreenRemove();var r=new URL(window.location.href).pathname.split("/")[2];$("#progress-bar-register").css("width","99%"),$(".div5").hide(),$(".div6").show(),$("#btn-go").hide(),$.ajax({method:"POST",url:"/api/register",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{name:$("#firstname").val()+" "+$("#lastname").val(),email:$("#email").val(),cellphone:$("#phone").val(),document:$("#document").val().replace(/[^0-9]/g,""),date_birth:$("#date_birth").val(),password:$("#password").val(),parameter:r,zip_code:$("#zip_code").val(),street:$("#street").val(),number:$("#number").val(),neighborhood:$("#neighborhood").val(),complement:$("#complement").val(),city:$("#city").val(),state:$("#state").val(),company_document:$("#company_document").val().replace(/[^0-9]/g,""),fantasy_name:$("#fantasy_name").val(),support_email:$("#support_email").val(),support_telephone:$("#support_telephone").val(),company_type:2,street_company:$("#street_company").val(),number_company:$("#number_company").val(),neighborhood_company:$("#neighborhood_company").val(),complement_company:$("#complement_company").val(),state_company:$("#state_company").val(),city_company:$("#city_company").val(),bank:$("#bank").val(),agency:$("#agency").val(),agency_digit:$("#agency_digit").val(),account:$("#account").val(),account_digit:$("#account_digit").val()},error:function(e){function r(r){return e.apply(this,arguments)}return r.toString=function(){return e.toString()},r}((function(e){if("422"==e.status)for(error in e.responseJSON.errors)a("error",String(e.responseJSON.errors[error]));$(".div5").show(),$(".div6").hide(),$("#btn-go").show(),loadingOnScreenRemove()})),success:function(r){loadingOnScreenRemove(),"true"==r.success?(e=r.access_token,$.ajax({method:"GET",url:"/api/register/welcome/",headers:{Authorization:"Bearer "+e,Accept:"application/json"},error:function(e){},success:function(e){}}),setTimeout(n,1e4)):($(".div5").show(),$(".div6").hide(),$("#btn-go").show(),loadingOnScreenRemove(),a("error",r.message))}})}();break;case"bank data physical person":!function(){if(!o())return a("error","Revise os dados informados"),loadingOnScreenRemove(),!1;loadingOnScreenRemove();var r=new URL(window.location.href).pathname.split("/")[2];$("#progress-bar-register").css("width","99%"),$(".div5").hide(),$(".div6").show(),$("#btn-go").hide(),$.ajax({method:"POST",url:"/api/register",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{name:$("#firstname").val()+" "+$("#lastname").val(),email:$("#email").val(),cellphone:$("#phone").val(),document:$("#document").val().replace(/[^0-9]/g,""),date_birth:$("#date_birth").val(),password:$("#password").val(),parameter:r,zip_code:$("#zip_code").val(),street:$("#street").val(),number:$("#number").val(),neighborhood:$("#neighborhood").val(),complement:$("#complement").val(),city:$("#city").val(),state:$("#state").val(),company_type:1,bank:$("#bank").val(),agency:$("#agency").val(),agency_digit:$("#agency_digit").val(),account:$("#account").val(),account_digit:$("#account_digit").val()},error:function(e){function r(r){return e.apply(this,arguments)}return r.toString=function(){return e.toString()},r}((function(e){if("422"==e.status)for(error in e.responseJSON.errors)a("error",String(e.responseJSON.errors[error]));$(".div5").show(),$(".div6").hide(),$("#btn-go").show(),loadingOnScreenRemove()})),success:function(r){loadingOnScreenRemove(),"true"==r.success?(e=r.access_token,$.ajax({method:"GET",url:"/api/register/welcome/",headers:{Authorization:"Bearer "+e,Accept:"application/json"},error:function(e){},success:function(e){}}),setTimeout(n,1e4)):($(".div5").show(),$(".div6").hide(),$("#btn-go").show(),loadingOnScreenRemove(),a("error",r.message))}})}()}})),$("#btn-physical-person").on("click",(function(e){e.preventDefault(),$(".div4").hide(),$(".div5").show(),$("#btn-go").show(),$("#alert-row").hide(),r="bank data physical person",$("#progress-bar-register").css("width","80%")})),$("#btn-juridical-person").on("click",(function(e){e.preventDefault(),$("#div-juridical-person").slideDown("fast"),$("#text-main").hide(),$("#text-company").show(),$("#btn-physical-person").hide(),$(this).hide(),$("#btn-go").show(),$("#alert-row").hide()})),$("#zip_code").on("input",(function(){var e=$("#zip_code").val().replace(/[^0-9]/g,"");if(8!==e.length)return!1;$.ajax({url:"https://viacep.com.br/ws/"+e+"/json/",type:"GET",cache:!1,async:!1,success:function(e){e.localidade&&$("#city").val(unescape(e.localidade)),e.bairro&&$("#neighborhood").val(unescape(e.bairro)),e.uf&&$("#state").val(unescape(e.uf)),e.logradouro&&$("#street").val(unescape(e.logradouro))}})})),$("#zip_code_company").on("input",(function(){var e=$("#zip_code_company").val().replace(/[^0-9]/g,"");if(8!==e.length)return!1;$.ajax({url:"https://viacep.com.br/ws/"+e+"/json/",type:"GET",cache:!1,async:!1,success:function(e){e.localidade&&$("#city_company").val(unescape(e.localidade)),e.bairro&&$("#neighborhood_company").val(unescape(e.bairro)),e.uf&&$("#state_company").val(unescape(e.uf)),e.logradouro&&$("#street_company").val(unescape(e.logradouro))}})})),$("#tokenEmail").on("input",(function(){var e=$(this).val();if(4!==e.length)return!1;$.ajax({method:"POST",url:"/api/register/match-email-verify-code",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{verifyCode:e},error:function(e){a("error",e.responseJSON.message)},success:function(e){!0===e.checked?($("#emailCheck").val(1),a("success",e.message)):($("#emailCheck").val(0),a("error",e.message))}})})),$("#tokenCellphone").on("input",(function(){var e=$(this).val();if(4!==e.length)return!1;$.ajax({method:"POST",url:"/api/register/match-cellphone-verify-code",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{verifyCode:e},error:function(e){a("error",e.responseJSON.message)},success:function(e){!0===e.checked?($("#cellphoneCheck").val(1),a("success",e.message)):($("#cellphoneCheck").val(0),a("error",e.message))}})})),$.ajax({method:"GET",url:"/api/register/get-banks/",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},error:function(e){},success:function(e){$.each(e.banks,(function(e,r){$("#bank").append("<option value='"+r.code+"'>"+r.name+"</option>")}))}}),$("[name='fileToUpload']").change((function(e){var r=e.target.getAttribute("id"),o=document.getElementById(r).files[0],n=new FileReader;n.readAsDataURL(o),n.onload=function(e){var n=document.getElementById("form-register"),t=new FormData(n);t.append("fileToUpload",o,r),$.ajax({method:"POST",url:"/api/register/upload-documents",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:t,processData:!1,cache:!1,contentType:!1,dataType:"json",error:function(e){errorAjaxResponse(e)},success:function(e){a("success",e.message)}})}})),$("#form-register input").on("keypress",(function(e){if(13==e.keyCode)return!1}))}));
