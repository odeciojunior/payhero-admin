$(document).ready((function(){function t(t){$.ajax({method:"GET",url:"/api/apps/notazz/export/"+extractIdFromPathName()+"/?"+e(!0)+"&format="+t,xhrFields:{responseType:"blob"},headers:{Authorization:$('meta[name="access-token"]').attr("content")},error:function(t){errorAjaxResponse(t)},success:function(t,e,a){!function(t,e){var a=e.getResponseHeader("Content-Type"),n=e.getResponseHeader("Content-Disposition").match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);n=n?n[0].replace("filename=",""):"";var o=document.createElement("a");o.style.display="none",document.body.appendChild(o),o.href=window.URL.createObjectURL(new Blob([t],{type:a})),o.setAttribute("download",n),o.click(),window.URL.revokeObjectURL(o.href),document.body.removeChild(o)}(t,a)}})}$.ajax({method:"GET",url:"/api/apps/notazz/"+extractIdFromPathName(),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t)},success:function(t,e,a){$("#title_integration").html(t.data.project_name)}}),$("#bt_get_csv").on("click",(function(){t("csv")})),$("#bt_get_xls").on("click",(function(){t("xls")})),$("#filtros").on("click",(function(){$("#div_filtros").is(":visible")?$("#div_filtros").slideUp():$("#div_filtros").slideDown()})),$("#bt_filtro").on("click",(function(t){t.preventDefault(),a()}));moment().subtract(30,"days").format("YYYY-MM-DD"),moment().format("YYYY-MM-DD");function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e={status:$("#status").val(),client:$("#comprador").val(),date_range:$("#date_range").val(),transaction:$("#transaction").val()};if(t){var a="";for(var n in e)dataValue=e[n],dataValue=dataValue.replace("#",""),a+="&"+n+"="+dataValue;return a}return e}function a(t){loadOnTable("#dados_tabela","#tabela_vendas"),null==t&&(t="/?"),$.ajax({method:"GET",url:"/api/apps/notazz/report/"+extractIdFromPathName()+t+e(!0),dataType:"json",headers:{Authorization:$('meta[name="access-token"]').attr("content"),Accept:"application/json"},error:function(t){errorAjaxResponse(t)},success:function(t){$("#dados_tabela").html(""),$("#tabela_vendas").addClass("table-striped");var e={1:"pending",2:"send",3:"completed",4:"error",5:"in_process",6:"error_max_attempts",7:"canceled",8:"rejected"};isEmpty(t.data)?$("#dados_tabela").html("<tr class='text-center'><td colspan='10' style='height: 70px;vertical-align: middle'> Nenhuma venda encontrada</td></tr>"):($.each(t.data,(function(t,a){dados="<tr>\n                                    <td class='display-sm-none display-m-none display-lg-none'>#".concat(a.sale_code,"</td>\n                                    <td>\n                                        <small>").concat(a.product,"</small>\n                                    </td>\n                                    <td class='display-sm-none display-m-none display-lg-none'>").concat(a.client,'</td>\n                                    <td>\n                                        <span class="badge badge-').concat(e[a.status],'">').concat(a.status_translate,"</span>\n                                    </td>\n                                    <td class='display-sm-none display-m-none'>").concat(a.updated_date,"</td>\n                                    <td class='display-sm-none'>").concat(a.value,"</td>\n                                    <td>\n                                        <a role='button' class='detalhes_venda pointer' sale=\"").concat(a.sale_code,'"><span class="o-eye-1"></span></button></a>\n                                    </td>\n                                </tr>'),$("#dados_tabela").append(dados)})),$("#date").val(moment(new Date).add(3,"days").format("YYYY-MM-DD")),$("#date").attr("min",moment(new Date).format("YYYY-MM-DD"))),pagination(t,"invoices",a),$("#export-excel").show()}})}$("#date_range").daterangepicker({startDate:moment().subtract(30,"days"),endDate:moment(),opens:"center",maxDate:moment().endOf("day"),alwaysShowCalendar:!0,showCustomRangeLabel:"Customizado",autoUpdateInput:!0,locale:{locale:"pt-br",format:"DD/MM/YYYY",applyLabel:"Aplicar",cancelLabel:"Limpar",fromLabel:"De",toLabel:"Até",customRangeLabel:"Customizado",weekLabel:"W",daysOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],firstDay:0},ranges:{Hoje:[moment(),moment()],Ontem:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Últimos 7 dias":[moment().subtract(6,"days"),moment()],"Últimos 30 dias":[moment().subtract(29,"days"),moment()],"Este mês":[moment().startOf("month"),moment().endOf("month")],"Mês passado":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")],"Vitalício":[moment("2018-01-01 00:00:00"),moment()]}},(function(t,e){t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD")})),$('input[name="date_range"]').on("cancel.daterangepicker",(function(t,e){$(this).val("")})),$(document).on({mouseenter:function(){$(this).css("cursor","pointer").text("Regerar"),$(this).css("background","#545B62")},mouseleave:function(){var t=$(this).attr("status");$(this).removeAttr("style"),$(this).text(t)}},".boleto-pending"),loadOnAny(".page-content",!0),a()}));
